<!-- HTML header for doxygen 1.8.11-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<title>DGtalTools: generic3dNormalEstimators.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/MathJax.js?config=TeX-MML-AM_CHTML/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="modern-doxygen-green.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">DGtalTools 
   &#160;<span id="projectnumber">1.5.beta</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function() { init_codefold(0); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_ad421f26fc787a8055cabb4d5b02df31.html">estimators</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle"><div class="title">generic3dNormalEstimators.cpp</div></div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span> </div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span><span class="preprocessor">#include &lt;fstream&gt;</span></div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span><span class="preprocessor">#include &lt;sstream&gt;</span></div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span> </div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span><span class="preprocessor">#include &quot;CLI11.hpp&quot;</span></div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span> </div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span><span class="preprocessor">#include &quot;DGtal/base/Common.h&quot;</span></div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span><span class="preprocessor">#include &quot;DGtal/base/CountedPtr.h&quot;</span></div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span><span class="preprocessor">#include &quot;DGtal/base/CountedConstPtrOrConstPtr.h&quot;</span></div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span><span class="preprocessor">#include &quot;DGtal/helpers/StdDefs.h&quot;</span></div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span><span class="preprocessor">#include &quot;DGtal/math/Statistic.h&quot;</span></div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span><span class="preprocessor">#include &quot;DGtal/math/MPolynomial.h&quot;</span></div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span><span class="preprocessor">#include &quot;DGtal/topology/LightImplicitDigitalSurface.h&quot;</span></div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span><span class="preprocessor">#include &quot;DGtal/graph/DepthFirstVisitor.h&quot;</span></div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span><span class="preprocessor">#include &quot;DGtal/graph/GraphVisitorRange.h&quot;</span></div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span><span class="preprocessor">#include &quot;DGtal/geometry/surfaces/estimation/VoronoiCovarianceMeasureOnDigitalSurface.h&quot;</span></div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span><span class="preprocessor">#include &quot;DGtal/geometry/surfaces/estimation/VCMDigitalSurfaceLocalEstimator.h&quot;</span></div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span><span class="preprocessor">#include &quot;DGtal/geometry/surfaces/estimation/TrueDigitalSurfaceLocalEstimator.h&quot;</span></div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span><span class="preprocessor">#include &quot;DGtal/geometry/surfaces/estimation/IIGeometricFunctors.h&quot;</span></div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span><span class="preprocessor">#include &quot;DGtal/geometry/surfaces/estimation/IntegralInvariantCovarianceEstimator.h&quot;</span></div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span><span class="preprocessor">#include &quot;DGtal/geometry/volumes/KanungoNoise.h&quot;</span></div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span><span class="preprocessor">#include &quot;DGtal/shapes/GaussDigitizer.h&quot;</span></div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span><span class="preprocessor">#include &quot;DGtal/shapes/ShapeGeometricFunctors.h&quot;</span></div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span><span class="preprocessor">#include &quot;DGtal/shapes/implicit/ImplicitPolynomial3Shape.h&quot;</span></div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span><span class="preprocessor">#include &quot;DGtal/images/ImageContainerBySTLVector.h&quot;</span></div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span><span class="preprocessor">#include &quot;DGtal/images/SimpleThresholdForegroundPredicate.h&quot;</span></div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span><span class="preprocessor">#include &quot;DGtal/io/readers/MPolynomialReader.h&quot;</span></div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span><span class="preprocessor">#include &quot;DGtal/io/colormaps/GradientColorMap.h&quot;</span></div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span><span class="preprocessor">#ifdef DGTAL_WITH_POLYSCOPE</span></div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span><span class="preprocessor">#include &quot;DGtal/io/viewers/PolyscopeViewer.h&quot;</span></div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span> </div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span><span class="keyword">using namespace </span>std;</div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span><span class="keyword">using namespace </span><a class="code hl_namespaceRef" href="https://dgtal-team.github.io/doc-nightly/namespaceDGtal.html">DGtal</a>;</div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span> </div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span> </div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span> </div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span><span class="keyword">struct </span>AllParams{</div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>  <span class="keywordtype">double</span> noise {0.0};</div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span>  <span class="keywordtype">double</span> minAABB {-10.0};</div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>  <span class="keywordtype">double</span> maxAABB {10.0};</div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span>  <span class="keywordtype">double</span> gridstep {1.0};</div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span>  <span class="keywordtype">double</span> R_radius {5.0};</div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>  <span class="keywordtype">double</span> r_radius {3.0};</div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span>  <span class="keywordtype">double</span> alpha {0.0};</div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>  <span class="keywordtype">double</span> trivial_radius {3.0};</div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span>  <span class="keywordtype">int</span> embedding {0};</div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>  std::string polynomials;</div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>  std::string estimator {<span class="stringliteral">&quot;True&quot;</span>};</div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>  std::string kernel {<span class="stringliteral">&quot;hat&quot;</span>};</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span>  std::string output {<span class="stringliteral">&quot;output&quot;</span>};</div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>  std::string exportX {<span class="stringliteral">&quot;None&quot;</span>};</div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>  std::string view {<span class="stringliteral">&quot;None&quot;</span>};</div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>  <span class="keywordtype">bool</span> angle_deviation_stats;</div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>  <span class="keywordtype">bool</span> normals;</div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span>  <span class="keywordtype">bool</span> noff;</div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span>};</div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span> </div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span> </div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span> </div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span><span class="keyword">template</span> &lt;<span class="keyword">typename</span> SCell, <span class="keyword">typename</span> RealVector&gt;</div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span><span class="keyword">struct </span>GradientMapAdapter {</div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span>  <span class="keyword">typedef</span> std::map&lt;SCell,RealVector&gt; SCell2RealVectorMap;</div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>  <span class="keyword">typedef</span> <a class="code hl_structRef" href="https://dgtal-team.github.io/doc-nightly/structDGtal_1_1SignedKhalimskyCell.html">SCell</a>                                 Argument;</div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span>  <span class="keyword">typedef</span> <a class="code hl_typedefRef" href="https://dgtal-team.github.io/doc-nightly/namespaceDGtal_1_1Z2i.html#a0db3f1b80b0d65707785c1072244befc">RealVector</a>                               Value;</div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>  GradientMapAdapter( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">ConstAlias&lt;SCell2RealVectorMap&gt;</a> map )</div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>    : myMap( map ) {}</div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span>  <a class="code hl_typedefRef" href="https://dgtal-team.github.io/doc-nightly/namespaceDGtal_1_1Z2i.html#a0db3f1b80b0d65707785c1072244befc">RealVector</a> operator()( <span class="keyword">const</span> Argument&amp; <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">arg</a> )<span class="keyword"> const</span></div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span><span class="keyword">  </span>{</div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span>    <span class="keyword">typename</span> SCell2RealVectorMap::const_iterator it = myMap-&gt;find( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">arg</a> );</div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span>    <span class="keywordflow">if</span> ( it != myMap-&gt;end() ) <span class="keywordflow">return</span> it-&gt;second;</div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span>    <span class="keywordflow">else</span> <span class="keywordflow">return</span> <a class="code hl_typedefRef" href="https://dgtal-team.github.io/doc-nightly/namespaceDGtal_1_1Z2i.html#a0db3f1b80b0d65707785c1072244befc">RealVector</a>();</div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>  }</div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>  <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">CountedConstPtrOrConstPtr&lt;SCell2RealVectorMap&gt;</a> myMap;</div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span>};</div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span> </div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span><span class="keyword">template</span> &lt;<span class="keyword">typename</span> SCellEmbedder&gt;</div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span><span class="keyword">struct </span>SCellEmbedderWithNormal : <span class="keyword">public</span> <a class="code hl_structRef" href="https://dgtal-team.github.io/doc-nightly/structDGtal_1_1CanonicSCellEmbedder.html">SCellEmbedder</a></div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>{</div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>  <span class="keyword">using </span><a class="code hl_functionRef" href="https://dgtal-team.github.io/doc-nightly/structDGtal_1_1CanonicSCellEmbedder.html#a179ed9fa2a17a402c88cf3a9adab87db">SCellEmbedder::space</a>;</div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>  <span class="keyword">using </span>SCellEmbedder::operator();</div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>  <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">SCellEmbedder::KSpace</a>          <a class="code hl_typedefRef" href="https://dgtal-team.github.io/doc-nightly/structDGtal_1_1CanonicSCellEmbedder.html#a1b7722292b1ed4efc2c7353e452c2b9a">KSpace</a>;</div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span>  <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code hl_structRef" href="https://dgtal-team.github.io/doc-nightly/structDGtal_1_1SignedKhalimskyCell.html">SCellEmbedder::SCell</a>            <a class="code hl_typedefRef" href="https://dgtal-team.github.io/doc-nightly/structDGtal_1_1CanonicSCellEmbedder.html#acd8f38ec4f86b9ef17ebde3f3c2987f4">SCell</a>;</div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span>  <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code hl_typedefRef" href="https://dgtal-team.github.io/doc-nightly/structDGtal_1_1CanonicSCellEmbedder.html#aba9d5a4aab713249a99e12765264d1da">SCellEmbedder::RealPoint</a>    <a class="code hl_typedefRef" href="https://dgtal-team.github.io/doc-nightly/structDGtal_1_1CanonicSCellEmbedder.html#aba9d5a4aab713249a99e12765264d1da">RealPoint</a>;</div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span>  <span class="keyword">typedef</span> <a class="code hl_structRef" href="https://dgtal-team.github.io/doc-nightly/structDGtal_1_1SignedKhalimskyCell.html">SCell</a>                                 <a class="code hl_typedefRef" href="https://dgtal-team.github.io/doc-nightly/structDGtal_1_1CanonicSCellEmbedder.html#a2073127fbff644a772ea9749b723e5e4">Argument</a>;</div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>  <span class="keyword">typedef</span> RealPoint                                <a class="code hl_typedefRef" href="https://dgtal-team.github.io/doc-nightly/structDGtal_1_1CanonicSCellEmbedder.html#ac30f6fa662fd17cf2276aa749c182194">Value</a>;</div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span>  <span class="keyword">typedef</span> <span class="keyword">typename</span> KSpace::Space::RealVector  <a class="code hl_typedefRef" href="https://dgtal-team.github.io/doc-nightly/namespaceDGtal_1_1Z2i.html#a0db3f1b80b0d65707785c1072244befc">RealVector</a>;</div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>  <span class="keyword">typedef</span> std::map&lt;SCell,RealVector&gt; SCell2RealVectorMap;</div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>  <span class="keyword">typedef</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">GradientMapAdapter&lt;SCell,RealVector&gt;</a> GradientMap;</div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span> </div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span>  SCellEmbedderWithNormal( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">ConstAlias&lt;SCellEmbedder&gt;</a> embedder,</div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span>                           <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">ConstAlias&lt;SCell2RealVectorMap&gt;</a> map )</div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span>    : <a class="code hl_structRef" href="https://dgtal-team.github.io/doc-nightly/structDGtal_1_1CanonicSCellEmbedder.html">SCellEmbedder</a>( embedder ), myMap( map )</div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span>  {}</div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span> </div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span>  GradientMap gradientMap()<span class="keyword"> const</span></div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span><span class="keyword">  </span>{</div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span>    <span class="keywordflow">return</span> GradientMap( myMap );</div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span>  }</div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span> </div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span>  <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">CountedConstPtrOrConstPtr&lt;SCell2RealVectorMap&gt;</a> myMap;</div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span>};</div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span> </div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span><span class="keyword">template</span> &lt;<span class="keyword">typename</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1DigitalSurface.html">DigitalSurface</a>,</div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span>          <span class="keyword">typename</span> Estimator&gt;</div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span><span class="keywordtype">void</span> exportNOFFSurface( <span class="keyword">const</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1DigitalSurface.html">DigitalSurface</a>&amp; surface,</div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span>                        <span class="keyword">const</span> Estimator&amp; estimator,</div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span>                        std::ostream&amp; output )</div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span>{</div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>  <span class="keyword">typedef</span> <span class="keyword">typename</span> DigitalSurface::KSpace <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1KhalimskySpaceND.html">KSpace</a>;</div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span>  <span class="keyword">typedef</span> <span class="keyword">typename</span> DigitalSurface::ConstIterator ConstIterator;</div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span>  <span class="keyword">typedef</span> <span class="keyword">typename</span> DigitalSurface::Surfel Surfel;</div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span>  <span class="keyword">typedef</span> <span class="keyword">typename</span> Estimator::Quantity Quantity;</div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span>  <span class="keyword">const</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1KhalimskySpaceND.html">KSpace</a>&amp; <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">ks</a> = surface.<a class="code hl_functionRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1DigitalSurface.html#afd10471a6fb7fb58e5f8744a8b6c1713">container</a>().space();</div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>  std::map&lt;Surfel,Quantity&gt; normals;</div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span>  <span class="keywordflow">for</span> ( ConstIterator it = surface.<a class="code hl_functionRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1DigitalSurface.html#a49b0a08eb04ed843d3e2c9ac7112a913">begin</a>(), <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">itE</a> = surface.<a class="code hl_functionRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1DigitalSurface.html#a00e29d43b6f9d0313c7134aec8c4f4ee">end</a>(); it != <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">itE</a>; ++it )</div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span>    {</div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span>      Quantity <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">n_est</a> = estimator.eval( it );</div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span>      normals[ *it ] = <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">n_est</a>;</div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span>    }</div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span>  <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">CanonicSCellEmbedder&lt;KSpace&gt;</a> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">surfelEmbedder</a>( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">ks</a> );</div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>  <span class="keyword">typedef</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">SCellEmbedderWithNormal&lt; CanonicSCellEmbedder&lt;KSpace&gt;</a> &gt; Embedder;</div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span>  Embedder embedder( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">surfelEmbedder</a>, normals );</div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span>  surface.<a class="code hl_functionRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1DigitalSurface.html#a9d7e0f91191e8e4d7ee1257623aff04f">exportAs3DNOFF</a>( output, embedder );</div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span>}</div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span> </div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span> </div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span><span class="keyword">template</span> &lt;<span class="keyword">typename</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1KhalimskySpaceND.html">KSpace</a>,</div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span>          <span class="keyword">typename</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">ImplicitShape</a>,</div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span>          <span class="keyword">typename</span> Surface,</div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span>          <span class="keyword">typename</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">TrueEstimator</a>,</div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span>          <span class="keyword">typename</span> Estimator&gt;</div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span><span class="keywordtype">void</span> computeEstimation</div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span>( <span class="keyword">const</span> AllParams &amp;<a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">params</a>,     <span class="comment">//&lt; command-line parameters</span></div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span>  <span class="keyword">const</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1KhalimskySpaceND.html">KSpace</a>&amp; K,                 <span class="comment">//&lt; cellular grid space</span></div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span>  <span class="keyword">const</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">ImplicitShape</a>&amp; shape,      <span class="comment">//&lt; implicit shape &quot;ground truth&quot;</span></div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span>  <span class="keyword">const</span> Surface&amp; surface,          <span class="comment">//&lt; digital surface approximating shape</span></div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span>  <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">TrueEstimator</a>&amp; <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">true_estimator</a>,   <span class="comment">//&lt; &quot;ground truth&quot; estimator</span></div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span>  Estimator&amp; estimator )           <span class="comment">//&lt; an initialized estimator</span></div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span>{</div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span>  <span class="keyword">typedef</span> <span class="keyword">typename</span> Surface::Surfel Surfel;</div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span>  <span class="keyword">typedef</span> <span class="keyword">typename</span> Estimator::Quantity Quantity;</div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span>  <span class="keyword">typedef</span> <span class="keywordtype">double</span> Scalar;</div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span>  <span class="keyword">typedef</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">DepthFirstVisitor&lt; Surface &gt;</a> Visitor;</div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span>  <span class="keyword">typedef</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">GraphVisitorRange&lt; Visitor &gt;</a> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">VisitorRange</a>;</div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span>  <span class="keyword">typedef</span> <span class="keyword">typename</span> VisitorRange::ConstIterator <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">VisitorConstIterator</a>;</div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span> </div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span>  std::string <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">fname</a> = <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">params</a>.output;</div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span>  <span class="keywordtype">string</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">nameEstimator</a> = <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">params</a>.estimator;</div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span>  <a class="code hl_variableRef" href="https://dgtal-team.github.io/doc-nightly/namespaceDGtal.html#a604c07ec391ad12a1f3fb6479993f112">trace</a>.<a class="code hl_functionRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Trace.html#a352b7160bf722e2f0bcbee5d0bad6ef3">beginBlock</a>( <span class="stringliteral">&quot;Computing &quot;</span> + <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">nameEstimator</a> + <span class="stringliteral">&quot;estimations.&quot;</span> );</div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span>  <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">CountedPtr&lt;VisitorRange&gt;</a> range( <span class="keyword">new</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">VisitorRange</a>( <span class="keyword">new</span> Visitor( surface, *(surface.begin()) )) );</div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span>  std::vector&lt;Quantity&gt; <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">n_estimations</a>;</div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span>  estimator.eval( range-&gt;begin(), range-&gt;end(), std::back_inserter( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">n_estimations</a> ) );</div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span>  <a class="code hl_variableRef" href="https://dgtal-team.github.io/doc-nightly/namespaceDGtal.html#a604c07ec391ad12a1f3fb6479993f112">trace</a>.<a class="code hl_functionRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Trace.html#ad054990834d2763627166540087a2980">info</a>() &lt;&lt; <span class="stringliteral">&quot;- nb estimations  = &quot;</span> &lt;&lt; <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">n_estimations</a>.size() &lt;&lt; std::endl;</div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span>  <a class="code hl_variableRef" href="https://dgtal-team.github.io/doc-nightly/namespaceDGtal.html#a604c07ec391ad12a1f3fb6479993f112">trace</a>.<a class="code hl_functionRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Trace.html#afa3a2874289734884107b1ce68ccb93d">endBlock</a>();</div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span> </div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span>  <a class="code hl_variableRef" href="https://dgtal-team.github.io/doc-nightly/namespaceDGtal.html#a604c07ec391ad12a1f3fb6479993f112">trace</a>.<a class="code hl_functionRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Trace.html#a352b7160bf722e2f0bcbee5d0bad6ef3">beginBlock</a>( <span class="stringliteral">&quot;Computing ground truth.&quot;</span> );</div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span>  range = <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">CountedPtr&lt;VisitorRange&gt;</a>( <span class="keyword">new</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">VisitorRange</a>( <span class="keyword">new</span> Visitor( surface, *(surface.begin()) )) );</div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span>  std::vector&lt;Quantity&gt; <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">n_true_estimations</a>;</div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span>  <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">true_estimator</a>.eval( range-&gt;begin(), range-&gt;end(), std::back_inserter( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">n_true_estimations</a> ) );</div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span>  <a class="code hl_variableRef" href="https://dgtal-team.github.io/doc-nightly/namespaceDGtal.html#a604c07ec391ad12a1f3fb6479993f112">trace</a>.<a class="code hl_functionRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Trace.html#ad054990834d2763627166540087a2980">info</a>() &lt;&lt; <span class="stringliteral">&quot;- nb estimations  = &quot;</span> &lt;&lt; <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">n_true_estimations</a>.size() &lt;&lt; std::endl;</div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span>  <a class="code hl_variableRef" href="https://dgtal-team.github.io/doc-nightly/namespaceDGtal.html#a604c07ec391ad12a1f3fb6479993f112">trace</a>.<a class="code hl_functionRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Trace.html#afa3a2874289734884107b1ce68ccb93d">endBlock</a>();</div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span> </div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span>  <a class="code hl_variableRef" href="https://dgtal-team.github.io/doc-nightly/namespaceDGtal.html#a604c07ec391ad12a1f3fb6479993f112">trace</a>.<a class="code hl_functionRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Trace.html#a352b7160bf722e2f0bcbee5d0bad6ef3">beginBlock</a>( <span class="stringliteral">&quot;Correcting orientations.&quot;</span> );</div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span>  <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">ASSERT</a>( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">n_estimations</a>.size() == <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">n_true_estimations</a>.size() );</div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span>  <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">n_estimations</a>.size(); ++i )</div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span>    <span class="keywordflow">if</span> ( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">n_estimations</a>[ i ].dot( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">n_true_estimations</a>[ i ] ) &lt; 0 )</div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span>      <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">n_estimations</a>[ i ] = -<a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">n_estimations</a>[ i ];</div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span>  <a class="code hl_variableRef" href="https://dgtal-team.github.io/doc-nightly/namespaceDGtal.html#a604c07ec391ad12a1f3fb6479993f112">trace</a>.<a class="code hl_functionRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Trace.html#afa3a2874289734884107b1ce68ccb93d">endBlock</a>();</div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span> </div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span>  <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">DGtal::GradientColorMap&lt;double&gt;</a> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">grad</a>( 0.0, 40.0 );</div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span>  <span class="comment">// 0 metallic blue, 5 light cyan, 10 light green, 15 light</span></div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span>  <span class="comment">// yellow, 20 yellow, 25 orange, 30 red, 35, dark red, 40- grey</span></div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span>  <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">grad</a>.addColor( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Color.html">DGtal::Color</a>( 128, 128, 255 ) ); <span class="comment">// 0</span></div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span>  <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">grad</a>.addColor( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Color.html">DGtal::Color</a>( 128, 255, 255 ) ); <span class="comment">// 5</span></div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span>  <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">grad</a>.addColor( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Color.html">DGtal::Color</a>( 128, 255, 128 ) ); <span class="comment">// 10</span></div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span>  <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">grad</a>.addColor( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Color.html">DGtal::Color</a>( 255, 255, 128 ) ); <span class="comment">// 15</span></div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span>  <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">grad</a>.addColor( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Color.html">DGtal::Color</a>( 255, 255, 0   ) ); <span class="comment">// 20</span></div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span>  <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">grad</a>.addColor( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Color.html">DGtal::Color</a>( 255, 128, 0   ) ); <span class="comment">// 25</span></div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span>  <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">grad</a>.addColor( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Color.html">DGtal::Color</a>( 255,   0, 0   ) ); <span class="comment">// 30</span></div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span>  <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">grad</a>.addColor( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Color.html">DGtal::Color</a>( 128,   0, 0   ) ); <span class="comment">// 35</span></div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span>  <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">grad</a>.addColor( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Color.html">DGtal::Color</a>( 128, 128, 128 ) ); <span class="comment">// 40</span></div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span> </div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span>  <span class="keywordflow">if</span> ( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">params</a>.angle_deviation_stats  )</div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span>    {</div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span>      <a class="code hl_variableRef" href="https://dgtal-team.github.io/doc-nightly/namespaceDGtal.html#a604c07ec391ad12a1f3fb6479993f112">trace</a>.<a class="code hl_functionRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Trace.html#a352b7160bf722e2f0bcbee5d0bad6ef3">beginBlock</a>( <span class="stringliteral">&quot;Computing angle deviation error stats.&quot;</span> );</div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span>      std::ostringstream <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">adev_sstr</a>;</div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span>      <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">adev_sstr</a> &lt;&lt; <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">fname</a> &lt;&lt; <span class="stringliteral">&quot;-&quot;</span> &lt;&lt; <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">nameEstimator</a> &lt;&lt; <span class="stringliteral">&quot;-angle-deviation-&quot;</span></div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span>                &lt;&lt; estimator.h() &lt;&lt; <span class="stringliteral">&quot;.txt&quot;</span>;</div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span>      <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">DGtal::Statistic&lt;Scalar&gt;</a> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">adev_stat</a>;</div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span>      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0;</div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span>      range = <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">CountedPtr&lt;VisitorRange&gt;</a>( <span class="keyword">new</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">VisitorRange</a>( <span class="keyword">new</span> Visitor( surface, *(surface.begin()) )) );</div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span>      <span class="keywordflow">for</span> ( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">VisitorConstIterator</a> it = range-&gt;begin(), <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">itE</a> = range-&gt;end(); it != <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">itE</a>; ++it, ++i )</div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span>        {</div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span>          Quantity <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">n_est</a> = <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">n_estimations</a>[ i ];</div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span>          Quantity <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">n_true_est</a> = <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">n_true_estimations</a>[ i ];</div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span>          Scalar <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">angle_error</a> = <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">acos</a>( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">n_est</a>.dot( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">n_true_est</a> ) );</div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span>          <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">adev_stat</a>.addValue( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">angle_error</a> );</div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span>        }</div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span>      <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">adev_stat</a>.terminate();</div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span>      std::ofstream <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">adev_output</a>( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">adev_sstr</a>.str().c_str() );</div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span>      <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">adev_output</a> &lt;&lt; <span class="stringliteral">&quot;# Average error X of the absolute angle between two vector estimations.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span>      <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">adev_output</a> &lt;&lt; <span class="stringliteral">&quot;# h L1 L2 Loo E[X] Var[X] Min[X] Max[X] Nb[X]&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span>      <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">adev_output</a> &lt;&lt; estimator.h()</div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span>                  &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">adev_stat</a>.mean() <span class="comment">// L1</span></div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span>                  &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">sqrt</a>( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">adev_stat</a>.unbiasedVariance()</div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span>                                  + <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">adev_stat</a>.mean()*<a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">adev_stat</a>.mean() ) <span class="comment">// L2</span></div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span>                  &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">adev_stat</a>.max() <span class="comment">// Loo</span></div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span>                  &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">adev_stat</a>.mean() <span class="comment">// E[X] (=L1)</span></div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span>                  &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">adev_stat</a>.unbiasedVariance() <span class="comment">// Var[X]</span></div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span>                  &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">adev_stat</a>.min() <span class="comment">// Min[X]</span></div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span>                  &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">adev_stat</a>.max() <span class="comment">// Max[X]</span></div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span>                  &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">adev_stat</a>.samples() <span class="comment">// Nb[X]</span></div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span>                  &lt;&lt; std::endl;</div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span>      <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">adev_output</a>.close();</div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span>      <a class="code hl_variableRef" href="https://dgtal-team.github.io/doc-nightly/namespaceDGtal.html#a604c07ec391ad12a1f3fb6479993f112">trace</a>.<a class="code hl_functionRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Trace.html#afa3a2874289734884107b1ce68ccb93d">endBlock</a>();</div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span>    }</div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span>  <span class="keywordflow">if</span> ( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">params</a>.exportX != <span class="stringliteral">&quot;None&quot;</span> )</div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span>    {</div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span>      <a class="code hl_variableRef" href="https://dgtal-team.github.io/doc-nightly/namespaceDGtal.html#a604c07ec391ad12a1f3fb6479993f112">trace</a>.<a class="code hl_functionRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Trace.html#a352b7160bf722e2f0bcbee5d0bad6ef3">beginBlock</a>( <span class="stringliteral">&quot;Exporting cell geometry.&quot;</span> );</div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span>      std::ostringstream <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">export_sstr</a>;</div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span>      <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">export_sstr</a> &lt;&lt; <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">fname</a> &lt;&lt; <span class="stringliteral">&quot;-&quot;</span> &lt;&lt; <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">nameEstimator</a> &lt;&lt; <span class="stringliteral">&quot;-cells-&quot;</span></div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span>                  &lt;&lt; estimator.h() &lt;&lt; <span class="stringliteral">&quot;.txt&quot;</span>;</div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span>      std::ofstream <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">export_output</a>( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">export_sstr</a>.str().c_str() );</div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span>      <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">export_output</a> &lt;&lt; <span class="stringliteral">&quot;# ImaGene viewer (viewSetOfSurfels) file format for displaying cells.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span>      <span class="keywordtype">bool</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">adev</a> =  <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">params</a>.exportX == <span class="stringliteral">&quot;AngleDeviation&quot;</span>;</div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span>      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0;</div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span>      range = <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">CountedPtr&lt;VisitorRange&gt;</a>( <span class="keyword">new</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">VisitorRange</a>( <span class="keyword">new</span> Visitor( surface, *(surface.begin()) )) );</div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span>      <span class="keywordflow">for</span> ( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">VisitorConstIterator</a> it = range-&gt;begin(), <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">itE</a> = range-&gt;end(); it != <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">itE</a>; ++it, ++i )</div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span>        {</div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span>          Quantity <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">n_est</a> = <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">n_estimations</a>[ i ];</div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span>          Quantity <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">n_true_est</a> = <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">n_true_estimations</a>[ i ];</div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span>          Scalar <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">angle_error</a> = <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">acos</a>( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">n_est</a>.dot( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">n_true_est</a> ) )*180.0 / 3.14159625;</div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span>          Surfel <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">s</a> = *it;</div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span>          <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">export_output</a></div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span>            &lt;&lt; <span class="stringliteral">&quot;CellN&quot;</span></div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span>            &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; min( 1023, max( 512+K.<a class="code hl_functionRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1KhalimskySpaceND.html#a71a96a90f5935efbccfff1d98b874c2d">sKCoord</a>( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">s</a>, 0 ), 0 ) )</div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span>            &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; min( 1023, max( 512+K.<a class="code hl_functionRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1KhalimskySpaceND.html#a71a96a90f5935efbccfff1d98b874c2d">sKCoord</a>( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">s</a>, 1 ), 0 ) )</div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span>            &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; min( 1023, max( 512+K.<a class="code hl_functionRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1KhalimskySpaceND.html#a71a96a90f5935efbccfff1d98b874c2d">sKCoord</a>( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">s</a>, 2 ), 0 ) )</div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span>            &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; K.<a class="code hl_functionRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1KhalimskySpaceND.html#a784c9fb251aba0f7db2adc934fe666b1">sSign</a>( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">s</a> );</div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span>          <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Color.html">Color</a> c = <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">grad</a>( 0 );</div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span>          <span class="keywordflow">if</span> ( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">adev</a> ) c = <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">grad</a>( max( 0.0, min( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">angle_error</a>, 40.0 ) ) );</div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span>          <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">export_output</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; ((<a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">double</a>) c.<a class="code hl_functionRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Color.html#aa487b3d008dc44964b10971ce8a26432">red</a>() / 255.0 )</div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span>                        &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; ((<span class="keywordtype">double</span>) c.<a class="code hl_functionRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Color.html#a5917f9d174eb75eae2ce49e7f40edbb7">green</a>() / 255.0 )</div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span>                        &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; ((<span class="keywordtype">double</span>) c.<a class="code hl_functionRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Color.html#af51469f44cfc0603c66efe150b1b0c33">blue</a>() / 255.0 );</div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span>          <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">export_output</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">n_est</a>[ 0 ] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">n_est</a>[ 1 ]</div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span>                        &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">n_est</a>[ 2 ] &lt;&lt; std::endl;</div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span>        }</div>
<div class="line"><a id="l00411" name="l00411"></a><span class="lineno">  411</span>      <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">export_output</a>.close();</div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno">  412</span>      <a class="code hl_variableRef" href="https://dgtal-team.github.io/doc-nightly/namespaceDGtal.html#a604c07ec391ad12a1f3fb6479993f112">trace</a>.<a class="code hl_functionRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Trace.html#afa3a2874289734884107b1ce68ccb93d">endBlock</a>();</div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span>    }</div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span>  <span class="keywordflow">if</span> ( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">params</a>.normals )</div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span>    {</div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span>      <a class="code hl_variableRef" href="https://dgtal-team.github.io/doc-nightly/namespaceDGtal.html#a604c07ec391ad12a1f3fb6479993f112">trace</a>.<a class="code hl_functionRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Trace.html#a352b7160bf722e2f0bcbee5d0bad6ef3">beginBlock</a>( <span class="stringliteral">&quot;Exporting cells normals.&quot;</span> );</div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span>      std::ostringstream <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">export_sstr</a>;</div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span>      <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">export_sstr</a> &lt;&lt; <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">fname</a> &lt;&lt; <span class="stringliteral">&quot;-&quot;</span> &lt;&lt; <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">nameEstimator</a> &lt;&lt; <span class="stringliteral">&quot;-normals-&quot;</span></div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span>                  &lt;&lt; estimator.h() &lt;&lt; <span class="stringliteral">&quot;.txt&quot;</span>;</div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span>      std::ofstream <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">export_output</a>( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">export_sstr</a>.str().c_str() );</div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span>      <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">export_output</a> &lt;&lt; <span class="stringliteral">&quot;# kx ky kz sign n_est[0] n_est[1] n_est[2] n_true[0] n_true[1] n_true[2]&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span>      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0;</div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span>      range = <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">CountedPtr&lt;VisitorRange&gt;</a>( <span class="keyword">new</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">VisitorRange</a>( <span class="keyword">new</span> Visitor( surface, *(surface.begin()) )) );</div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno">  424</span>      <span class="keywordflow">for</span> ( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">VisitorConstIterator</a> it = range-&gt;begin(), <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">itE</a> = range-&gt;end(); it != <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">itE</a>; ++it, ++i )</div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span>        {</div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span>          Quantity <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">n_est</a> = <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">n_estimations</a>[ i ];</div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span>          Quantity <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">n_true_est</a> = <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">n_true_estimations</a>[ i ];</div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span>          Surfel <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">s</a> = *it;</div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span>          <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">export_output</a></div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span>            &lt;&lt; K.<a class="code hl_functionRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1KhalimskySpaceND.html#a71a96a90f5935efbccfff1d98b874c2d">sKCoord</a>( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">s</a>, 0 ) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; K.<a class="code hl_functionRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1KhalimskySpaceND.html#a71a96a90f5935efbccfff1d98b874c2d">sKCoord</a>( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">s</a>, 1 ) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; K.<a class="code hl_functionRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1KhalimskySpaceND.html#a71a96a90f5935efbccfff1d98b874c2d">sKCoord</a>( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">s</a>, 2 )</div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span>            &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; K.<a class="code hl_functionRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1KhalimskySpaceND.html#a784c9fb251aba0f7db2adc934fe666b1">sSign</a>( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">s</a> )</div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span>            &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">n_est</a>[ 0 ] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">n_est</a>[ 1 ] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">n_est</a>[ 2 ]</div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span>            &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">n_true_est</a>[ 0 ] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">n_true_est</a>[ 1 ] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">n_true_est</a>[ 2 ]</div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span>            &lt;&lt; std::endl;</div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span>        }</div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span>      <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">export_output</a>.close();</div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span>      <a class="code hl_variableRef" href="https://dgtal-team.github.io/doc-nightly/namespaceDGtal.html#a604c07ec391ad12a1f3fb6479993f112">trace</a>.<a class="code hl_functionRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Trace.html#afa3a2874289734884107b1ce68ccb93d">endBlock</a>();</div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span>    }</div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span>  <span class="keywordflow">if</span> ( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">params</a>.noff )</div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span>    {</div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span>      <a class="code hl_variableRef" href="https://dgtal-team.github.io/doc-nightly/namespaceDGtal.html#a604c07ec391ad12a1f3fb6479993f112">trace</a>.<a class="code hl_functionRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Trace.html#a352b7160bf722e2f0bcbee5d0bad6ef3">beginBlock</a>( <span class="stringliteral">&quot;Exporting NOFF file.&quot;</span> );</div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span>      std::ostringstream <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">export_sstr</a>;</div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span>      <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">export_sstr</a> &lt;&lt; <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">fname</a> &lt;&lt; <span class="stringliteral">&quot;-&quot;</span> &lt;&lt; <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">nameEstimator</a> &lt;&lt; <span class="stringliteral">&quot;-noff-&quot;</span></div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span>                  &lt;&lt; estimator.h() &lt;&lt; <span class="stringliteral">&quot;.off&quot;</span>;</div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno">  445</span>      std::ofstream <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">export_output</a>( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">export_sstr</a>.str().c_str() );</div>
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno">  446</span>      std::map&lt;Surfel,Quantity&gt; normals;</div>
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno">  447</span>      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0;</div>
<div class="line"><a id="l00448" name="l00448"></a><span class="lineno">  448</span>      range = <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">CountedPtr&lt;VisitorRange&gt;</a>( <span class="keyword">new</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">VisitorRange</a>( <span class="keyword">new</span> Visitor( surface, *(surface.begin()) )) );</div>
<div class="line"><a id="l00449" name="l00449"></a><span class="lineno">  449</span>      <span class="keywordflow">for</span> ( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">VisitorConstIterator</a> it = range-&gt;begin(), <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">itE</a> = range-&gt;end(); it != <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">itE</a>; ++it, ++i )</div>
<div class="line"><a id="l00450" name="l00450"></a><span class="lineno">  450</span>        {</div>
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno">  451</span>          Quantity <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">n_est</a> = <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">n_estimations</a>[ i ];</div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno">  452</span>          normals[ *it ] = <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">n_est</a>;</div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span>        }</div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span>      <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">CanonicSCellEmbedder&lt;KSpace&gt;</a> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">surfelEmbedder</a>( K );</div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno">  455</span>      <span class="keyword">typedef</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">SCellEmbedderWithNormal&lt; CanonicSCellEmbedder&lt;KSpace&gt;</a> &gt; Embedder;</div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span>      Embedder embedder( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">surfelEmbedder</a>, normals );</div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span>      surface.exportAs3DNOFF( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">export_output</a>, embedder );</div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span>      <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">export_output</a>.close();</div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span>      <a class="code hl_variableRef" href="https://dgtal-team.github.io/doc-nightly/namespaceDGtal.html#a604c07ec391ad12a1f3fb6479993f112">trace</a>.<a class="code hl_functionRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Trace.html#afa3a2874289734884107b1ce68ccb93d">endBlock</a>();</div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span>    }</div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span><span class="preprocessor">#ifdef DGTAL_WITH_POLYSCOPE</span></div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span>  <span class="keywordflow">if</span> ( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">params</a>.exportX != <span class="stringliteral">&quot;None&quot;</span> )</div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span>    {</div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno">  464</span>      <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">KSpace::Space</a> <a class="code hl_typedefRef" href="https://dgtal-team.github.io/doc-nightly/namespaceDGtal_1_1Z2i.html#a9b96ab8175cf9c54b1f451858ccd46a4">Space</a>;</div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span>      <span class="keyword">typedef</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">PolyscopeViewer&lt;Space,KSpace&gt;</a> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">MyViewever3D</a>;</div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno">  466</span>      <span class="keywordtype">int</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">argc</a> = 1;</div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno">  467</span>      <span class="keywordtype">char</span> name[] = <span class="stringliteral">&quot;Viewer&quot;</span>;</div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno">  468</span>      <span class="keywordtype">char</span>* <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">argv</a>[ 1 ];</div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno">  469</span>      <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">argv</a>[ 0 ] = name;</div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span>      Surfel <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">s</a>;</div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno">  471</span>      <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">MyViewever3D</a> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">viewer</a>( K );</div>
<div class="line"><a id="l00472" name="l00472"></a><span class="lineno">  472</span>      <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">viewer</a>.drawAsSimplified();</div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno">  473</span>      <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">viewer</a>.allowReuseList = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno">  474</span> </div>
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno">  475</span>      <a class="code hl_variableRef" href="https://dgtal-team.github.io/doc-nightly/namespaceDGtal.html#a604c07ec391ad12a1f3fb6479993f112">trace</a>.<a class="code hl_functionRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Trace.html#a352b7160bf722e2f0bcbee5d0bad6ef3">beginBlock</a>( <span class="stringliteral">&quot;Viewing surface.&quot;</span> );</div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span>      <span class="keywordtype">bool</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">adev</a> =  <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">params</a>.view == <span class="stringliteral">&quot;AngleDeviation&quot;</span>;</div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno">  477</span> </div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno">  478</span>      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0;</div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno">  479</span>      range = <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">CountedPtr&lt;VisitorRange&gt;</a>( <span class="keyword">new</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">VisitorRange</a>( <span class="keyword">new</span> Visitor( surface, *(surface.begin()) )) );</div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno">  480</span>      <span class="keywordflow">for</span> ( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">VisitorConstIterator</a> it = range-&gt;begin(), <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">itE</a> = range-&gt;end(); it != <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">itE</a>; ++it, ++i )</div>
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno">  481</span>        {</div>
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno">  482</span>          Quantity <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">n_est</a> = <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">n_estimations</a>[ i ];</div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span>          Quantity <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">n_true_est</a> = <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">n_true_estimations</a>[ i ];</div>
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno">  484</span>          Scalar <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">angle_error</a> = <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">acos</a>( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">n_est</a>.dot( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">n_true_est</a> ) )*180.0 / 3.14159625;</div>
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno">  485</span>          <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">s</a> = *it;</div>
<div class="line"><a id="l00486" name="l00486"></a><span class="lineno">  486</span>          <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Color.html">Color</a> c = <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">grad</a>( 0 );</div>
<div class="line"><a id="l00487" name="l00487"></a><span class="lineno">  487</span>          <span class="keywordflow">if</span> ( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">adev</a> ) c = <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">grad</a>( max( 0.0, min( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">angle_error</a>, 40.0 ) ) );</div>
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno">  488</span>          <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">viewer</a>.drawColor( c );</div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno">  489</span>          <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">viewer</a> &lt;&lt; <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">WithQuantity</a>(<a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">s</a>, <span class="stringliteral">&quot;normal&quot;</span>, <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">n_est</a>);</div>
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno">  490</span>        }</div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno">  491</span>      <a class="code hl_variableRef" href="https://dgtal-team.github.io/doc-nightly/namespaceDGtal.html#a604c07ec391ad12a1f3fb6479993f112">trace</a>.<a class="code hl_functionRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Trace.html#afa3a2874289734884107b1ce68ccb93d">endBlock</a>();</div>
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno">  492</span>      <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">viewer</a>.show();</div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno">  493</span>    }</div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno">  495</span> </div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno">  496</span>}</div>
<div class="line"><a id="l00497" name="l00497"></a><span class="lineno">  497</span> </div>
<div class="line"><a id="l00498" name="l00498"></a><span class="lineno">  498</span><span class="keyword">template</span> &lt;<span class="keyword">typename</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1KhalimskySpaceND.html">KSpace</a>,</div>
<div class="line"><a id="l00499" name="l00499"></a><span class="lineno">  499</span>          <span class="keyword">typename</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">ImplicitShape</a>,</div>
<div class="line"><a id="l00500" name="l00500"></a><span class="lineno">  500</span>          <span class="keyword">typename</span> Surface,</div>
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno">  501</span>          <span class="keyword">typename</span> KernelFunction,</div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno">  502</span>          <span class="keyword">typename</span> PointPredicate&gt;</div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span><span class="keywordtype">void</span> chooseEstimator</div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span>( <span class="keyword">const</span> AllParams &amp;<a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">params</a>,     <span class="comment">//&lt; command-line parameters</span></div>
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno">  505</span>  <span class="keyword">const</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1KhalimskySpaceND.html">KSpace</a>&amp; K,                 <span class="comment">//&lt; cellular grid space</span></div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno">  506</span>  <span class="keyword">const</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">ImplicitShape</a>&amp; shape, <span class="comment">//&lt; implicit shape &quot;ground truth&quot;</span></div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span>  <span class="keyword">const</span> Surface&amp; surface,     <span class="comment">//&lt; digital surface approximating shape</span></div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span>  <span class="keyword">const</span> KernelFunction&amp; <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">chi</a>,  <span class="comment">//&lt; the kernel function</span></div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno">  509</span>  <span class="keyword">const</span> PointPredicate&amp; <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">ptPred</a> )   <span class="comment">//&lt; analysed implicit digital shape as a PointPredicate</span></div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span>{</div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span>  <span class="keywordtype">string</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">nameEstimator</a> = <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">params</a>.estimator;</div>
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno">  512</span>  <span class="keywordtype">double</span> h = <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">params</a>.gridstep;</div>
<div class="line"><a id="l00513" name="l00513"></a><span class="lineno">  513</span>  <span class="keyword">typedef</span> <a class="code hl_structRef" href="https://dgtal-team.github.io/doc-nightly/structDGtal_1_1functors_1_1ShapeGeometricFunctors_1_1ShapeNormalVectorFunctor.html">functors::ShapeGeometricFunctors::ShapeNormalVectorFunctor&lt;ImplicitShape&gt;</a> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">NormalFunctor</a>;</div>
<div class="line"><a id="l00514" name="l00514"></a><span class="lineno">  514</span>  <span class="keyword">typedef</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">TrueDigitalSurfaceLocalEstimator&lt;KSpace, ImplicitShape, NormalFunctor&gt;</a> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">TrueEstimator</a>;</div>
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno">  515</span>  <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">TrueEstimator</a> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">true_estimator</a>;</div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span>  <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">true_estimator</a>.attach( shape );</div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span>  <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">true_estimator</a>.setParams( K, <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">NormalFunctor</a>(), 20, 0.1, 0.01 );</div>
<div class="line"><a id="l00518" name="l00518"></a><span class="lineno">  518</span>  <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">true_estimator</a>.init( h, surface.begin(), surface.end() );</div>
<div class="line"><a id="l00519" name="l00519"></a><span class="lineno">  519</span>  <span class="keywordflow">if</span> ( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">nameEstimator</a> == <span class="stringliteral">&quot;True&quot;</span> )</div>
<div class="line"><a id="l00520" name="l00520"></a><span class="lineno">  520</span>    {</div>
<div class="line"><a id="l00521" name="l00521"></a><span class="lineno">  521</span>      <a class="code hl_variableRef" href="https://dgtal-team.github.io/doc-nightly/namespaceDGtal.html#a604c07ec391ad12a1f3fb6479993f112">trace</a>.<a class="code hl_functionRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Trace.html#a352b7160bf722e2f0bcbee5d0bad6ef3">beginBlock</a>( <span class="stringliteral">&quot;Chosen estimator is: True.&quot;</span> );</div>
<div class="line"><a id="l00522" name="l00522"></a><span class="lineno">  522</span>      <span class="keyword">typedef</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">TrueDigitalSurfaceLocalEstimator&lt;KSpace, ImplicitShape, NormalFunctor&gt;</a> Estimator;</div>
<div class="line"><a id="l00523" name="l00523"></a><span class="lineno">  523</span>      Estimator estimator;</div>
<div class="line"><a id="l00524" name="l00524"></a><span class="lineno">  524</span>      estimator.attach( shape );</div>
<div class="line"><a id="l00525" name="l00525"></a><span class="lineno">  525</span>      estimator.setParams( K, <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">NormalFunctor</a>(), 20, 0.1, 0.01 );</div>
<div class="line"><a id="l00526" name="l00526"></a><span class="lineno">  526</span>      estimator.init( h, surface.begin(), surface.end() );</div>
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno">  527</span>      <a class="code hl_variableRef" href="https://dgtal-team.github.io/doc-nightly/namespaceDGtal.html#a604c07ec391ad12a1f3fb6479993f112">trace</a>.<a class="code hl_functionRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Trace.html#afa3a2874289734884107b1ce68ccb93d">endBlock</a>();</div>
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno">  528</span>      computeEstimation( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">params</a>, K, shape, surface, <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">true_estimator</a>, estimator );</div>
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno">  529</span>    }</div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">nameEstimator</a> == <span class="stringliteral">&quot;VCM&quot;</span> )</div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span>    {</div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno">  532</span>      <a class="code hl_variableRef" href="https://dgtal-team.github.io/doc-nightly/namespaceDGtal.html#a604c07ec391ad12a1f3fb6479993f112">trace</a>.<a class="code hl_functionRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Trace.html#a352b7160bf722e2f0bcbee5d0bad6ef3">beginBlock</a>( <span class="stringliteral">&quot;Chosen estimator is: VCM.&quot;</span> );</div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span>      <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">KSpace::Space</a> <a class="code hl_typedefRef" href="https://dgtal-team.github.io/doc-nightly/namespaceDGtal_1_1Z2i.html#a9b96ab8175cf9c54b1f451858ccd46a4">Space</a>;</div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span>      <span class="keyword">typedef</span> <span class="keyword">typename</span> Surface::DigitalSurfaceContainer <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">SurfaceContainer</a>;</div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno">  535</span>      <span class="keyword">typedef</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">ExactPredicateLpSeparableMetric&lt;Space,2&gt;</a> Metric;</div>
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno">  536</span>      <span class="keyword">typedef</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1VoronoiCovarianceMeasureOnDigitalSurface.html">VoronoiCovarianceMeasureOnDigitalSurface</a>&lt;<a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">SurfaceContainer</a>,Metric,</div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span>                                                       KernelFunction&gt; VCMOnSurface;</div>
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno">  538</span>      <span class="keyword">typedef</span> <a class="code hl_structRef" href="https://dgtal-team.github.io/doc-nightly/structDGtal_1_1functors_1_1VCMNormalVectorFunctor.html">functors::VCMNormalVectorFunctor&lt;VCMOnSurface&gt;</a> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">NormalFunctor</a>;</div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span>      <span class="keyword">typedef</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1VCMDigitalSurfaceLocalEstimator.html">VCMDigitalSurfaceLocalEstimator</a>&lt;<a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">SurfaceContainer</a>,Metric,</div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span>                                              KernelFunction, <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">NormalFunctor</a>&gt; <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">VCMNormalEstimator</a>;</div>
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno">  541</span>      <span class="keywordtype">int</span> embedding = <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">params</a>.embedding;</div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno">  542</span>      <a class="code hl_enumerationRef" href="https://dgtal-team.github.io/doc-nightly/namespaceDGtal.html#aaad242ffef715835e8928579a506b2d5">Surfel2PointEmbedding</a> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">embType</a> = embedding == 0 ? <a class="code hl_variableRef" href="https://dgtal-team.github.io/doc-nightly/namespaceDGtal.html#aaad242ffef715835e8928579a506b2d5ac0a8bc5774ff6530ee71a7cacd6ca6f4">Pointels</a> :</div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span>                                      embedding == 1 ? <a class="code hl_variableRef" href="https://dgtal-team.github.io/doc-nightly/namespaceDGtal.html#aaad242ffef715835e8928579a506b2d5a800e26ee60cfa63833cffca955ae401f">InnerSpel</a> : <a class="code hl_variableRef" href="https://dgtal-team.github.io/doc-nightly/namespaceDGtal.html#aaad242ffef715835e8928579a506b2d5a0630efc9b8129aa1ad3233bba9f08423">OuterSpel</a>;</div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno">  544</span>      <span class="keywordtype">double</span> R = <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">params</a>.R_radius;</div>
<div class="line"><a id="l00545" name="l00545"></a><span class="lineno">  545</span>      <span class="keywordtype">double</span> r = <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">params</a>.r_radius;</div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno">  546</span>      <span class="keywordtype">double</span> t = <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">params</a>.trivial_radius;</div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno">  547</span>      <span class="keywordtype">double</span> alpha = <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">params</a>.alpha;</div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno">  548</span>      <span class="keywordflow">if</span> ( alpha != 0.0 ) R *= <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">pow</a>( h, alpha-1.0 );</div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno">  549</span>      <span class="keywordflow">if</span> ( alpha != 0.0 ) r *= <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">pow</a>( h, alpha-1.0 );</div>
<div class="line"><a id="l00550" name="l00550"></a><span class="lineno">  550</span>      <a class="code hl_variableRef" href="https://dgtal-team.github.io/doc-nightly/namespaceDGtal.html#a604c07ec391ad12a1f3fb6479993f112">trace</a>.<a class="code hl_functionRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Trace.html#ad054990834d2763627166540087a2980">info</a>() &lt;&lt; <span class="stringliteral">&quot;- R=&quot;</span> &lt;&lt; R &lt;&lt; <span class="stringliteral">&quot; r=&quot;</span> &lt;&lt; r &lt;&lt; <span class="stringliteral">&quot; t=&quot;</span> &lt;&lt; t &lt;&lt; std::endl;</div>
<div class="line"><a id="l00551" name="l00551"></a><span class="lineno">  551</span>      <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">VCMNormalEstimator</a> estimator;</div>
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno">  552</span>      estimator.attach( surface );</div>
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno">  553</span>      estimator.setParams( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">embType</a>, R, r, <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">chi</a>, t, Metric(), <span class="keyword">true</span> );</div>
<div class="line"><a id="l00554" name="l00554"></a><span class="lineno">  554</span>      estimator.init( h, surface.begin(), surface.end() );</div>
<div class="line"><a id="l00555" name="l00555"></a><span class="lineno">  555</span>      <a class="code hl_variableRef" href="https://dgtal-team.github.io/doc-nightly/namespaceDGtal.html#a604c07ec391ad12a1f3fb6479993f112">trace</a>.<a class="code hl_functionRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Trace.html#afa3a2874289734884107b1ce68ccb93d">endBlock</a>();</div>
<div class="line"><a id="l00556" name="l00556"></a><span class="lineno">  556</span>      computeEstimation( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">params</a>, K, shape, surface, <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">true_estimator</a>, estimator );</div>
<div class="line"><a id="l00557" name="l00557"></a><span class="lineno">  557</span>    }</div>
<div class="line"><a id="l00558" name="l00558"></a><span class="lineno">  558</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">nameEstimator</a> == <span class="stringliteral">&quot;II&quot;</span> )</div>
<div class="line"><a id="l00559" name="l00559"></a><span class="lineno">  559</span>    {</div>
<div class="line"><a id="l00560" name="l00560"></a><span class="lineno">  560</span>      <a class="code hl_variableRef" href="https://dgtal-team.github.io/doc-nightly/namespaceDGtal.html#a604c07ec391ad12a1f3fb6479993f112">trace</a>.<a class="code hl_functionRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Trace.html#a352b7160bf722e2f0bcbee5d0bad6ef3">beginBlock</a>( <span class="stringliteral">&quot;Chosen estimator is: II.&quot;</span> );</div>
<div class="line"><a id="l00561" name="l00561"></a><span class="lineno">  561</span>      <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">KSpace::Space</a> <a class="code hl_typedefRef" href="https://dgtal-team.github.io/doc-nightly/namespaceDGtal_1_1Z2i.html#a9b96ab8175cf9c54b1f451858ccd46a4">Space</a>;</div>
<div class="line"><a id="l00562" name="l00562"></a><span class="lineno">  562</span>      <span class="keyword">typedef</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">HyperRectDomain&lt;Space&gt;</a> <a class="code hl_typedefRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1IteratorCompletionTraits_3_01ArrayImageAdapter_3_01TArrayIterator_00_01TDomain_01_4_01_4_1_1DistanceFunctor.html#a79a0f67cc951326052b97eeea300e2c1">Domain</a>;</div>
<div class="line"><a id="l00563" name="l00563"></a><span class="lineno">  563</span>      <span class="keyword">typedef</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">ImageContainerBySTLVector&lt; Domain, bool&gt;</a> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Image.html">Image</a>;</div>
<div class="line"><a id="l00564" name="l00564"></a><span class="lineno">  564</span>      <span class="keyword">typedef</span> <span class="keyword">typename</span> Domain::ConstIterator <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">DomainConstIterator</a>;</div>
<div class="line"><a id="l00565" name="l00565"></a><span class="lineno">  565</span>      <span class="keyword">typedef</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1functors_1_1SimpleThresholdForegroundPredicate.html">functors::SimpleThresholdForegroundPredicate&lt;Image&gt;</a> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">ThresholdedImage</a>;</div>
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno">  566</span>      <span class="keyword">typedef</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1functors_1_1IINormalDirectionFunctor.html">functors::IINormalDirectionFunctor&lt;Space&gt;</a> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">IINormalFunctor</a>;</div>
<div class="line"><a id="l00567" name="l00567"></a><span class="lineno">  567</span>      <span class="keyword">typedef</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">IntegralInvariantCovarianceEstimator&lt;KSpace, ThresholdedImage, IINormalFunctor&gt;</a> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">IINormalEstimator</a>;</div>
<div class="line"><a id="l00568" name="l00568"></a><span class="lineno">  568</span>      <span class="keywordtype">double</span> r = <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">params</a>.r_radius;</div>
<div class="line"><a id="l00569" name="l00569"></a><span class="lineno">  569</span>      <span class="keywordtype">double</span> alpha = <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">params</a>.alpha;</div>
<div class="line"><a id="l00570" name="l00570"></a><span class="lineno">  570</span>      <span class="keywordflow">if</span> ( alpha != 0.0 ) r *= <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">pow</a>( h, alpha-1.0 );</div>
<div class="line"><a id="l00571" name="l00571"></a><span class="lineno">  571</span>      <a class="code hl_variableRef" href="https://dgtal-team.github.io/doc-nightly/namespaceDGtal.html#a604c07ec391ad12a1f3fb6479993f112">trace</a>.<a class="code hl_functionRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Trace.html#ad054990834d2763627166540087a2980">info</a>() &lt;&lt; <span class="stringliteral">&quot; r=&quot;</span> &lt;&lt; r &lt;&lt; std::endl;</div>
<div class="line"><a id="l00572" name="l00572"></a><span class="lineno">  572</span>      <a class="code hl_variableRef" href="https://dgtal-team.github.io/doc-nightly/namespaceDGtal.html#a604c07ec391ad12a1f3fb6479993f112">trace</a>.<a class="code hl_functionRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Trace.html#a352b7160bf722e2f0bcbee5d0bad6ef3">beginBlock</a>( <span class="stringliteral">&quot;Preparing characteristic set.&quot;</span> );</div>
<div class="line"><a id="l00573" name="l00573"></a><span class="lineno">  573</span>      <a class="code hl_typedefRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1IteratorCompletionTraits_3_01ArrayImageAdapter_3_01TArrayIterator_00_01TDomain_01_4_01_4_1_1DistanceFunctor.html#a79a0f67cc951326052b97eeea300e2c1">Domain</a> domain( K.<a class="code hl_functionRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1KhalimskySpaceND.html#a7d29934a9526b8fc98cb96e63ed073b1">lowerBound</a>(), K.<a class="code hl_functionRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1KhalimskySpaceND.html#a172911293fde220bd965f147a9a320da">upperBound</a>() );</div>
<div class="line"><a id="l00574" name="l00574"></a><span class="lineno">  574</span>      <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Image.html">Image</a> image( domain );</div>
<div class="line"><a id="l00575" name="l00575"></a><span class="lineno">  575</span>      <span class="keywordflow">for</span> ( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">DomainConstIterator</a> it = domain.begin(), <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">itE</a> = domain.end(); it != <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">itE</a>; ++it )</div>
<div class="line"><a id="l00576" name="l00576"></a><span class="lineno">  576</span>        {</div>
<div class="line"><a id="l00577" name="l00577"></a><span class="lineno">  577</span>          image.setValue( *it, <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">ptPred</a>( *it ) );</div>
<div class="line"><a id="l00578" name="l00578"></a><span class="lineno">  578</span>        }</div>
<div class="line"><a id="l00579" name="l00579"></a><span class="lineno">  579</span>      <a class="code hl_variableRef" href="https://dgtal-team.github.io/doc-nightly/namespaceDGtal.html#a604c07ec391ad12a1f3fb6479993f112">trace</a>.<a class="code hl_functionRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Trace.html#afa3a2874289734884107b1ce68ccb93d">endBlock</a>();</div>
<div class="line"><a id="l00580" name="l00580"></a><span class="lineno">  580</span>      <a class="code hl_variableRef" href="https://dgtal-team.github.io/doc-nightly/namespaceDGtal.html#a604c07ec391ad12a1f3fb6479993f112">trace</a>.<a class="code hl_functionRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Trace.html#a352b7160bf722e2f0bcbee5d0bad6ef3">beginBlock</a>( <span class="stringliteral">&quot;Initialize II estimator.&quot;</span> );</div>
<div class="line"><a id="l00581" name="l00581"></a><span class="lineno">  581</span>      <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">ThresholdedImage</a> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">thresholdedImage</a>( image, <span class="keyword">false</span> );</div>
<div class="line"><a id="l00582" name="l00582"></a><span class="lineno">  582</span>      <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">IINormalEstimator</a> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">ii_estimator</a>( K, <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">thresholdedImage</a> );</div>
<div class="line"><a id="l00583" name="l00583"></a><span class="lineno">  583</span>      <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">ii_estimator</a>.setParams( r );</div>
<div class="line"><a id="l00584" name="l00584"></a><span class="lineno">  584</span>      <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">ii_estimator</a>.init( h, surface.begin(), surface.end() );</div>
<div class="line"><a id="l00585" name="l00585"></a><span class="lineno">  585</span>      <a class="code hl_variableRef" href="https://dgtal-team.github.io/doc-nightly/namespaceDGtal.html#a604c07ec391ad12a1f3fb6479993f112">trace</a>.<a class="code hl_functionRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Trace.html#afa3a2874289734884107b1ce68ccb93d">endBlock</a>();</div>
<div class="line"><a id="l00586" name="l00586"></a><span class="lineno">  586</span>      <a class="code hl_variableRef" href="https://dgtal-team.github.io/doc-nightly/namespaceDGtal.html#a604c07ec391ad12a1f3fb6479993f112">trace</a>.<a class="code hl_functionRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Trace.html#afa3a2874289734884107b1ce68ccb93d">endBlock</a>();</div>
<div class="line"><a id="l00587" name="l00587"></a><span class="lineno">  587</span>      computeEstimation( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">params</a>, K, shape, surface, <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">true_estimator</a>, <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">ii_estimator</a> );</div>
<div class="line"><a id="l00588" name="l00588"></a><span class="lineno">  588</span>   }</div>
<div class="line"><a id="l00589" name="l00589"></a><span class="lineno">  589</span> </div>
<div class="line"><a id="l00590" name="l00590"></a><span class="lineno">  590</span>}</div>
<div class="line"><a id="l00591" name="l00591"></a><span class="lineno">  591</span> </div>
<div class="line"><a id="l00592" name="l00592"></a><span class="lineno">  592</span><span class="keyword">template</span> &lt;<span class="keyword">typename</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1KhalimskySpaceND.html">KSpace</a>,</div>
<div class="line"><a id="l00593" name="l00593"></a><span class="lineno">  593</span>          <span class="keyword">typename</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">ImplicitShape</a>,</div>
<div class="line"><a id="l00594" name="l00594"></a><span class="lineno">  594</span>          <span class="keyword">typename</span> Surface,</div>
<div class="line"><a id="l00595" name="l00595"></a><span class="lineno">  595</span>          <span class="keyword">typename</span> PointPredicate&gt;</div>
<div class="line"><a id="l00596" name="l00596"></a><span class="lineno">  596</span><span class="keywordtype">void</span> chooseKernel</div>
<div class="line"><a id="l00597" name="l00597"></a><span class="lineno">  597</span>( <span class="keyword">const</span> AllParams&amp; <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">params</a>,     <span class="comment">//&lt; command-line parameters</span></div>
<div class="line"><a id="l00598" name="l00598"></a><span class="lineno">  598</span>  <span class="keyword">const</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1KhalimskySpaceND.html">KSpace</a>&amp; K,                 <span class="comment">//&lt; cellular grid space</span></div>
<div class="line"><a id="l00599" name="l00599"></a><span class="lineno">  599</span>  <span class="keyword">const</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">ImplicitShape</a>&amp; shape,      <span class="comment">//&lt; implicit shape &quot;ground truth&quot;</span></div>
<div class="line"><a id="l00600" name="l00600"></a><span class="lineno">  600</span>  <span class="keyword">const</span> Surface&amp; surface,          <span class="comment">//&lt; digital surface approximating shape</span></div>
<div class="line"><a id="l00601" name="l00601"></a><span class="lineno">  601</span>  <span class="keyword">const</span> PointPredicate&amp; <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">ptPred</a> )   <span class="comment">//&lt; analysed implicit digital shape as a PointPredicate</span></div>
<div class="line"><a id="l00602" name="l00602"></a><span class="lineno">  602</span>{</div>
<div class="line"><a id="l00603" name="l00603"></a><span class="lineno">  603</span>  <span class="keywordtype">string</span> kernel = <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">params</a>.kernel;</div>
<div class="line"><a id="l00604" name="l00604"></a><span class="lineno">  604</span>  <span class="keywordtype">double</span> h = <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">params</a>.gridstep;</div>
<div class="line"><a id="l00605" name="l00605"></a><span class="lineno">  605</span>  <span class="keywordtype">double</span> r = <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">params</a>.r_radius;</div>
<div class="line"><a id="l00606" name="l00606"></a><span class="lineno">  606</span>  <span class="keywordtype">double</span> alpha = <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">params</a>.alpha;</div>
<div class="line"><a id="l00607" name="l00607"></a><span class="lineno">  607</span>  <span class="keywordflow">if</span> ( alpha != 0.0 ) r *= <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">pow</a>( h, alpha-1.0 );</div>
<div class="line"><a id="l00608" name="l00608"></a><span class="lineno">  608</span>  <span class="keywordflow">if</span> ( kernel == <span class="stringliteral">&quot;hat&quot;</span> ) {</div>
<div class="line"><a id="l00609" name="l00609"></a><span class="lineno">  609</span>    <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1PointVector.html">KSpace::Point</a> <a class="code hl_typedefRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1IteratorCompletionTraits_3_01ArrayImageAdapter_3_01TArrayIterator_00_01TDomain_01_4_01_4_1_1DistanceFunctor.html#af185de5027177db2d1b4a0b775be8c3f">Point</a>;</div>
<div class="line"><a id="l00610" name="l00610"></a><span class="lineno">  610</span>    <span class="keyword">typedef</span> <a class="code hl_structRef" href="https://dgtal-team.github.io/doc-nightly/structDGtal_1_1functors_1_1HatPointFunction.html">functors::HatPointFunction&lt;Point,double&gt;</a> KernelFunction;</div>
<div class="line"><a id="l00611" name="l00611"></a><span class="lineno">  611</span>    KernelFunction <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">chi_r</a>( 1.0, r );</div>
<div class="line"><a id="l00612" name="l00612"></a><span class="lineno">  612</span>    chooseEstimator( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">params</a>, K, shape, surface, <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">chi_r</a>, <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">ptPred</a> );</div>
<div class="line"><a id="l00613" name="l00613"></a><span class="lineno">  613</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( kernel == <span class="stringliteral">&quot;ball&quot;</span> ) {</div>
<div class="line"><a id="l00614" name="l00614"></a><span class="lineno">  614</span>    <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1PointVector.html">KSpace::Point</a> <a class="code hl_typedefRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1IteratorCompletionTraits_3_01ArrayImageAdapter_3_01TArrayIterator_00_01TDomain_01_4_01_4_1_1DistanceFunctor.html#af185de5027177db2d1b4a0b775be8c3f">Point</a>;</div>
<div class="line"><a id="l00615" name="l00615"></a><span class="lineno">  615</span>    <span class="keyword">typedef</span> <a class="code hl_structRef" href="https://dgtal-team.github.io/doc-nightly/structDGtal_1_1functors_1_1BallConstantPointFunction.html">functors::BallConstantPointFunction&lt;Point,double&gt;</a> KernelFunction;</div>
<div class="line"><a id="l00616" name="l00616"></a><span class="lineno">  616</span>    KernelFunction <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">chi_r</a>( 1.0, r );</div>
<div class="line"><a id="l00617" name="l00617"></a><span class="lineno">  617</span>    chooseEstimator( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">params</a>, K, shape, surface, <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">chi_r</a>, <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">ptPred</a> );</div>
<div class="line"><a id="l00618" name="l00618"></a><span class="lineno">  618</span>  }</div>
<div class="line"><a id="l00619" name="l00619"></a><span class="lineno">  619</span>}</div>
<div class="line"><a id="l00620" name="l00620"></a><span class="lineno">  620</span> </div>
<div class="line"><a id="l00621" name="l00621"></a><span class="lineno">  621</span><span class="keyword">template</span> &lt;<span class="keyword">typename</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1KhalimskySpaceND.html">KSpace</a>,</div>
<div class="line"><a id="l00622" name="l00622"></a><span class="lineno">  622</span>          <span class="keyword">typename</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">ImplicitShape</a>,</div>
<div class="line"><a id="l00623" name="l00623"></a><span class="lineno">  623</span>          <span class="keyword">typename</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">ImplicitDigitalShape</a> &gt;</div>
<div class="line"><a id="l00624" name="l00624"></a><span class="lineno">  624</span><span class="keywordtype">int</span> chooseSurface</div>
<div class="line"><a id="l00625" name="l00625"></a><span class="lineno">  625</span>( <span class="keyword">const</span> AllParams &amp;<a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">params</a>, <span class="comment">//&lt; command-line parameters</span></div>
<div class="line"><a id="l00626" name="l00626"></a><span class="lineno">  626</span>  <span class="keyword">const</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1KhalimskySpaceND.html">KSpace</a>&amp; K,                 <span class="comment">//&lt; cellular grid space</span></div>
<div class="line"><a id="l00627" name="l00627"></a><span class="lineno">  627</span>  <span class="keyword">const</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">ImplicitShape</a>&amp; shape,      <span class="comment">//&lt; implicit shape &quot;ground truth&quot;</span></div>
<div class="line"><a id="l00628" name="l00628"></a><span class="lineno">  628</span>  <span class="keyword">const</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">ImplicitDigitalShape</a>&amp; <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">dshape</a> ) <span class="comment">//&lt; analysed implicit digital shape</span></div>
<div class="line"><a id="l00629" name="l00629"></a><span class="lineno">  629</span>{</div>
<div class="line"><a id="l00630" name="l00630"></a><span class="lineno">  630</span>  <span class="comment">// Selecting a model of surface depending on noise / not noise.</span></div>
<div class="line"><a id="l00631" name="l00631"></a><span class="lineno">  631</span>  <span class="keyword">typedef</span> <span class="keywordtype">double</span> Scalar;</div>
<div class="line"><a id="l00632" name="l00632"></a><span class="lineno">  632</span>  <span class="keywordflow">if</span> ( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">params</a>.noise == 0.0 )</div>
<div class="line"><a id="l00633" name="l00633"></a><span class="lineno">  633</span>    { <span class="comment">// no noise</span></div>
<div class="line"><a id="l00634" name="l00634"></a><span class="lineno">  634</span>      <a class="code hl_variableRef" href="https://dgtal-team.github.io/doc-nightly/namespaceDGtal.html#a604c07ec391ad12a1f3fb6479993f112">trace</a>.<a class="code hl_functionRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Trace.html#a352b7160bf722e2f0bcbee5d0bad6ef3">beginBlock</a>( <span class="stringliteral">&quot;Make digital surface...&quot;</span> );</div>
<div class="line"><a id="l00635" name="l00635"></a><span class="lineno">  635</span>      <span class="keyword">typedef</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">LightImplicitDigitalSurface&lt;KSpace,ImplicitDigitalShape&gt;</a> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">SurfaceContainer</a>;</div>
<div class="line"><a id="l00636" name="l00636"></a><span class="lineno">  636</span>      <span class="keyword">typedef</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">DigitalSurface&lt; SurfaceContainer &gt;</a> Surface;</div>
<div class="line"><a id="l00637" name="l00637"></a><span class="lineno">  637</span>      <span class="keyword">typedef</span> <span class="keyword">typename</span> Surface::Surfel Surfel;</div>
<div class="line"><a id="l00638" name="l00638"></a><span class="lineno">  638</span>      <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1SurfelAdjacency.html">SurfelAdjacency&lt; KSpace::dimension &gt;</a> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">surfAdj</a>( <span class="keyword">true</span> );</div>
<div class="line"><a id="l00639" name="l00639"></a><span class="lineno">  639</span>      Surfel <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">bel</a>;</div>
<div class="line"><a id="l00640" name="l00640"></a><span class="lineno">  640</span>      <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l00641" name="l00641"></a><span class="lineno">  641</span>        <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">bel</a> = <a class="code hl_functionRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Surfaces.html#a48e3a0e7c4728f6a6f23ec6f468a41b8">Surfaces&lt;KSpace&gt;::findABel</a>( K, <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">dshape</a>, 10000 );</div>
<div class="line"><a id="l00642" name="l00642"></a><span class="lineno">  642</span>      } <span class="keywordflow">catch</span> (<a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1InputException.html">DGtal::InputException</a> e) {</div>
<div class="line"><a id="l00643" name="l00643"></a><span class="lineno">  643</span>        <a class="code hl_variableRef" href="https://dgtal-team.github.io/doc-nightly/namespaceDGtal.html#a604c07ec391ad12a1f3fb6479993f112">trace</a>.<a class="code hl_functionRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Trace.html#a1e786a1f3b1047e92b73c82f67e3c295">error</a>() &lt;&lt; <span class="stringliteral">&quot;ERROR Unable to find bel.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l00644" name="l00644"></a><span class="lineno">  644</span>        <span class="keywordflow">return</span> 3;</div>
<div class="line"><a id="l00645" name="l00645"></a><span class="lineno">  645</span>      }</div>
<div class="line"><a id="l00646" name="l00646"></a><span class="lineno">  646</span>      <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">SurfaceContainer</a>* <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">surfaceContainer</a> = <span class="keyword">new</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">SurfaceContainer</a>( K, <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">dshape</a>, <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">surfAdj</a>, <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">bel</a> );</div>
<div class="line"><a id="l00647" name="l00647"></a><span class="lineno">  647</span>      <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">CountedPtr&lt;Surface&gt;</a> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">ptrSurface</a>( <span class="keyword">new</span> Surface( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">surfaceContainer</a> ) ); <span class="comment">// acquired</span></div>
<div class="line"><a id="l00648" name="l00648"></a><span class="lineno">  648</span>      <a class="code hl_variableRef" href="https://dgtal-team.github.io/doc-nightly/namespaceDGtal.html#a604c07ec391ad12a1f3fb6479993f112">trace</a>.<a class="code hl_functionRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Trace.html#ad054990834d2763627166540087a2980">info</a>() &lt;&lt; <span class="stringliteral">&quot;- surface component has &quot;</span> &lt;&lt; <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">ptrSurface</a>-&gt;size() &lt;&lt; <span class="stringliteral">&quot; surfels.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l00649" name="l00649"></a><span class="lineno">  649</span>      <a class="code hl_variableRef" href="https://dgtal-team.github.io/doc-nightly/namespaceDGtal.html#a604c07ec391ad12a1f3fb6479993f112">trace</a>.<a class="code hl_functionRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Trace.html#afa3a2874289734884107b1ce68ccb93d">endBlock</a>();</div>
<div class="line"><a id="l00650" name="l00650"></a><span class="lineno">  650</span>      chooseKernel( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">params</a>, K, shape, *<a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">ptrSurface</a>, <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">dshape</a> );</div>
<div class="line"><a id="l00651" name="l00651"></a><span class="lineno">  651</span>    }</div>
<div class="line"><a id="l00652" name="l00652"></a><span class="lineno">  652</span>  <span class="keywordflow">else</span></div>
<div class="line"><a id="l00653" name="l00653"></a><span class="lineno">  653</span>    { <span class="comment">// noise</span></div>
<div class="line"><a id="l00654" name="l00654"></a><span class="lineno">  654</span>      <a class="code hl_variableRef" href="https://dgtal-team.github.io/doc-nightly/namespaceDGtal.html#a604c07ec391ad12a1f3fb6479993f112">trace</a>.<a class="code hl_functionRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Trace.html#a352b7160bf722e2f0bcbee5d0bad6ef3">beginBlock</a>( <span class="stringliteral">&quot;Make digital surface...&quot;</span> );</div>
<div class="line"><a id="l00655" name="l00655"></a><span class="lineno">  655</span>      <span class="keyword">typedef</span> <span class="keyword">typename</span> ImplicitDigitalShape::Domain <a class="code hl_typedefRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1IteratorCompletionTraits_3_01ArrayImageAdapter_3_01TArrayIterator_00_01TDomain_01_4_01_4_1_1DistanceFunctor.html#a79a0f67cc951326052b97eeea300e2c1">Domain</a>;</div>
<div class="line"><a id="l00656" name="l00656"></a><span class="lineno">  656</span>      <span class="keyword">typedef</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">KanungoNoise&lt; ImplicitDigitalShape, Domain &gt;</a> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">KanungoPredicate</a>;</div>
<div class="line"><a id="l00657" name="l00657"></a><span class="lineno">  657</span>      <span class="keyword">typedef</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">LightImplicitDigitalSurface&lt; KSpace, KanungoPredicate &gt;</a> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">SurfaceContainer</a>;</div>
<div class="line"><a id="l00658" name="l00658"></a><span class="lineno">  658</span>      <span class="keyword">typedef</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">DigitalSurface&lt; SurfaceContainer &gt;</a> Surface;</div>
<div class="line"><a id="l00659" name="l00659"></a><span class="lineno">  659</span>      <span class="keyword">typedef</span> <span class="keyword">typename</span> Surface::Surfel Surfel;</div>
<div class="line"><a id="l00660" name="l00660"></a><span class="lineno">  660</span>      <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1SurfelAdjacency.html">SurfelAdjacency&lt; KSpace::dimension &gt;</a> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">surfAdj</a>( <span class="keyword">true</span> );</div>
<div class="line"><a id="l00661" name="l00661"></a><span class="lineno">  661</span>      Surfel <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">bel</a>;</div>
<div class="line"><a id="l00662" name="l00662"></a><span class="lineno">  662</span>      <span class="keyword">const</span> <a class="code hl_typedefRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1IteratorCompletionTraits_3_01ArrayImageAdapter_3_01TArrayIterator_00_01TDomain_01_4_01_4_1_1DistanceFunctor.html#a79a0f67cc951326052b97eeea300e2c1">Domain</a> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">shapeDomain</a> = <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">dshape</a>.getDomain();</div>
<div class="line"><a id="l00663" name="l00663"></a><span class="lineno">  663</span>      <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">KanungoPredicate</a>* <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">noisified_dshape</a> = <span class="keyword">new</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">KanungoPredicate</a>( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">dshape</a>, <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">shapeDomain</a>, <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">params</a>.noise );</div>
<div class="line"><a id="l00664" name="l00664"></a><span class="lineno">  664</span>      <span class="comment">// We have to search for a big connected component.</span></div>
<div class="line"><a id="l00665" name="l00665"></a><span class="lineno">  665</span>      <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">CountedPtr&lt;Surface&gt;</a> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">ptrSurface</a>;</div>
<div class="line"><a id="l00666" name="l00666"></a><span class="lineno">  666</span>      <span class="keywordtype">double</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">minsize</a> = <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">dshape</a>.getUpperBound()[0] - <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">dshape</a>.getLowerBound()[0];</div>
<div class="line"><a id="l00667" name="l00667"></a><span class="lineno">  667</span>      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">nb_surfels</a> = 0;</div>
<div class="line"><a id="l00668" name="l00668"></a><span class="lineno">  668</span>      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">tries</a> = 0;</div>
<div class="line"><a id="l00669" name="l00669"></a><span class="lineno">  669</span>      <span class="keywordflow">do</span> {</div>
<div class="line"><a id="l00670" name="l00670"></a><span class="lineno">  670</span>        <span class="keywordflow">try</span> { <span class="comment">// Search initial bel</span></div>
<div class="line"><a id="l00671" name="l00671"></a><span class="lineno">  671</span>          <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">bel</a> = <a class="code hl_functionRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Surfaces.html#a48e3a0e7c4728f6a6f23ec6f468a41b8">Surfaces&lt;KSpace&gt;::findABel</a>( K, *<a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">noisified_dshape</a>, 10000 );</div>
<div class="line"><a id="l00672" name="l00672"></a><span class="lineno">  672</span>        } <span class="keywordflow">catch</span> (<a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1InputException.html">DGtal::InputException</a> e) {</div>
<div class="line"><a id="l00673" name="l00673"></a><span class="lineno">  673</span>          <a class="code hl_variableRef" href="https://dgtal-team.github.io/doc-nightly/namespaceDGtal.html#a604c07ec391ad12a1f3fb6479993f112">trace</a>.<a class="code hl_functionRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Trace.html#a1e786a1f3b1047e92b73c82f67e3c295">error</a>() &lt;&lt; <span class="stringliteral">&quot;ERROR Unable to find bel.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l00674" name="l00674"></a><span class="lineno">  674</span>          <span class="keywordflow">return</span> 3;</div>
<div class="line"><a id="l00675" name="l00675"></a><span class="lineno">  675</span>        }</div>
<div class="line"><a id="l00676" name="l00676"></a><span class="lineno">  676</span>        <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">SurfaceContainer</a>* <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">surfaceContainer</a> = <span class="keyword">new</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">SurfaceContainer</a>( K, *<a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">noisified_dshape</a>, <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">surfAdj</a>, <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">bel</a> );</div>
<div class="line"><a id="l00677" name="l00677"></a><span class="lineno">  677</span>        <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">ptrSurface</a> = <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">CountedPtr&lt;Surface&gt;</a>( <span class="keyword">new</span> Surface( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">surfaceContainer</a> ) ); <span class="comment">// acquired</span></div>
<div class="line"><a id="l00678" name="l00678"></a><span class="lineno">  678</span>        <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">nb_surfels</a> = <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">ptrSurface</a>-&gt;size();</div>
<div class="line"><a id="l00679" name="l00679"></a><span class="lineno">  679</span>      } <span class="keywordflow">while</span> ( ( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">nb_surfels</a> &lt; 2 * <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">minsize</a> ) &amp;&amp; ( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">tries</a>++ &lt; 150 ) );</div>
<div class="line"><a id="l00680" name="l00680"></a><span class="lineno">  680</span>      <span class="keywordflow">if</span>( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">tries</a> &gt;= 150 )</div>
<div class="line"><a id="l00681" name="l00681"></a><span class="lineno">  681</span>        {</div>
<div class="line"><a id="l00682" name="l00682"></a><span class="lineno">  682</span>          <a class="code hl_variableRef" href="https://dgtal-team.github.io/doc-nightly/namespaceDGtal.html#a604c07ec391ad12a1f3fb6479993f112">trace</a>.<a class="code hl_functionRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Trace.html#a1e786a1f3b1047e92b73c82f67e3c295">error</a>() &lt;&lt; <span class="stringliteral">&quot;ERROR cannot find a proper bel in a big enough component.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l00683" name="l00683"></a><span class="lineno">  683</span>          <span class="keywordflow">return</span> 4;</div>
<div class="line"><a id="l00684" name="l00684"></a><span class="lineno">  684</span>        }</div>
<div class="line"><a id="l00685" name="l00685"></a><span class="lineno">  685</span>      <a class="code hl_variableRef" href="https://dgtal-team.github.io/doc-nightly/namespaceDGtal.html#a604c07ec391ad12a1f3fb6479993f112">trace</a>.<a class="code hl_functionRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Trace.html#ad054990834d2763627166540087a2980">info</a>() &lt;&lt; <span class="stringliteral">&quot;- surface component has &quot;</span> &lt;&lt; <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">nb_surfels</a> &lt;&lt; <span class="stringliteral">&quot; surfels.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l00686" name="l00686"></a><span class="lineno">  686</span>      <a class="code hl_variableRef" href="https://dgtal-team.github.io/doc-nightly/namespaceDGtal.html#a604c07ec391ad12a1f3fb6479993f112">trace</a>.<a class="code hl_functionRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Trace.html#afa3a2874289734884107b1ce68ccb93d">endBlock</a>();</div>
<div class="line"><a id="l00687" name="l00687"></a><span class="lineno">  687</span>      chooseKernel( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">params</a>, K, shape, *<a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">ptrSurface</a>, *<a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">noisified_dshape</a> );</div>
<div class="line"><a id="l00688" name="l00688"></a><span class="lineno">  688</span>    }</div>
<div class="line"><a id="l00689" name="l00689"></a><span class="lineno">  689</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a id="l00690" name="l00690"></a><span class="lineno">  690</span>}</div>
<div class="line"><a id="l00691" name="l00691"></a><span class="lineno">  691</span> </div>
<div class="line"><a id="l00692" name="l00692"></a><span class="lineno">  692</span> </div>
<div class="line"><a id="l00694" name="l00694"></a><span class="lineno">  694</span><span class="keywordtype">int</span> main( <span class="keywordtype">int</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">argc</a>, <span class="keywordtype">char</span>** <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">argv</a> )</div>
<div class="line"><a id="l00695" name="l00695"></a><span class="lineno">  695</span>{</div>
<div class="line"><a id="l00696" name="l00696"></a><span class="lineno">  696</span>  </div>
<div class="line"><a id="l00697" name="l00697"></a><span class="lineno">  697</span>  AllParams <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">allParams</a>;</div>
<div class="line"><a id="l00698" name="l00698"></a><span class="lineno">  698</span>  </div>
<div class="line"><a id="l00699" name="l00699"></a><span class="lineno">  699</span>  <span class="comment">// parse command line ----------------------------------------------</span></div>
<div class="line"><a id="l00700" name="l00700"></a><span class="lineno">  700</span>  CLI::App <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">app</a>;</div>
<div class="line"><a id="l00701" name="l00701"></a><span class="lineno">  701</span>  std::stringstream <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">ss_descr</a>;</div>
<div class="line"><a id="l00702" name="l00702"></a><span class="lineno">  702</span>  <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">ss_descr</a> &lt;&lt; <span class="stringliteral">&quot;Computes a normal vector field over a digitized 3D implicit surface for several estimators (II|VCM|Trivial|True), specified with -e. You may add Kanungo noise with option -N. These estimators are compared with ground truth. You may then: 1) visualize the normals or the angle deviations with -V (if WITH_QGL_VIEWER is enabled), 2) outputs them as a list of cells/estimations with -n, 3) outputs them as a ImaGene file with -O, 4) outputs them as a NOFF file with -O, 5) computes estimation statistics with option -S.&quot;</span>;</div>
<div class="line"><a id="l00703" name="l00703"></a><span class="lineno">  703</span>  </div>
<div class="line"><a id="l00704" name="l00704"></a><span class="lineno">  704</span>  <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">ss_descr</a> &lt;&lt; <span class="stringliteral">&quot;Example of use:\n&quot;</span></div>
<div class="line"><a id="l00705" name="l00705"></a><span class="lineno">  705</span>       &lt;&lt; <span class="stringliteral">&quot;./generic3dNormalEstimator -p \&quot;90-3*x^2-2*y^2-z^2\&quot; -o VCM-ellipse -a -10 -A 10 -e VCM -R 3 -r 3 -t 2 -E 0 -x Normals&quot;</span> &lt;&lt; <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">endl</a> &lt;&lt; <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">endl</a></div>
<div class="line"><a id="l00706" name="l00706"></a><span class="lineno">  706</span>       &lt;&lt; <span class="stringliteral">&quot;Example of implicit surfaces (specified by -p):&quot;</span> &lt;&lt; <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">endl</a></div>
<div class="line"><a id="l00707" name="l00707"></a><span class="lineno">  707</span>       &lt;&lt; <span class="stringliteral">&quot; - ellipse  : 90-3*x^2-2*y^2-z^2 &quot;</span> &lt;&lt; <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">endl</a></div>
<div class="line"><a id="l00708" name="l00708"></a><span class="lineno">  708</span>       &lt;&lt; <span class="stringliteral">&quot; - torus    : -1*(x^2+y^2+z^2+6*6-2*2)^2+4*6*6*(x^2+y^2) &quot;</span> &lt;&lt; <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">endl</a></div>
<div class="line"><a id="l00709" name="l00709"></a><span class="lineno">  709</span>       &lt;&lt; <span class="stringliteral">&quot; - rcube    : 6561-x^4-y^4-z^4&quot;</span> &lt;&lt; <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">endl</a></div>
<div class="line"><a id="l00710" name="l00710"></a><span class="lineno">  710</span>       &lt;&lt; <span class="stringliteral">&quot; - goursat  : 8-0.03*x^4-0.03*y^4-0.03*z^4+2*x^2+2*y^2+2*z^2&quot;</span> &lt;&lt; <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">endl</a></div>
<div class="line"><a id="l00711" name="l00711"></a><span class="lineno">  711</span>       &lt;&lt; <span class="stringliteral">&quot; - distel   : 10000-(x^2+y^2+z^2+1000*(x^2+y^2)*(x^2+z^2)*(y^2+z^2))&quot;</span> &lt;&lt; <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">endl</a></div>
<div class="line"><a id="l00712" name="l00712"></a><span class="lineno">  712</span>       &lt;&lt; <span class="stringliteral">&quot; - leopold  : 100-(x^2*y^2*z^2+4*x^2+4*y^2+3*z^2)&quot;</span> &lt;&lt; <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">endl</a></div>
<div class="line"><a id="l00713" name="l00713"></a><span class="lineno">  713</span>       &lt;&lt; <span class="stringliteral">&quot; - diabolo  : x^2-(y^2+z^2)^2&quot;</span> &lt;&lt; <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">endl</a></div>
<div class="line"><a id="l00714" name="l00714"></a><span class="lineno">  714</span>       &lt;&lt; <span class="stringliteral">&quot; - heart    : -1*(x^2+2.25*y^2+z^2-1)^3+x^2*z^3+0.1125*y^2*z^3&quot;</span> &lt;&lt; <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">endl</a></div>
<div class="line"><a id="l00715" name="l00715"></a><span class="lineno">  715</span>       &lt;&lt; <span class="stringliteral">&quot; - crixxi   : -0.9*(y^2+z^2-1)^2-(x^2+y^2-1)^3&quot;</span> &lt;&lt; <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">endl</a> &lt;&lt; <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">endl</a>;</div>
<div class="line"><a id="l00716" name="l00716"></a><span class="lineno">  716</span>  <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">ss_descr</a> &lt;&lt; <span class="stringliteral">&quot;Implemented estimators (specified by -e):&quot;</span> &lt;&lt; <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">endl</a></div>
<div class="line"><a id="l00717" name="l00717"></a><span class="lineno">  717</span>       &lt;&lt; <span class="stringliteral">&quot; - True     : supposed to be the ground truth for computations. Of course, it is only approximations.&quot;</span> &lt;&lt; <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">endl</a></div>
<div class="line"><a id="l00718" name="l00718"></a><span class="lineno">  718</span>       &lt;&lt; <span class="stringliteral">&quot; - VCM      : normal estimator by digital Voronoi Covariance Matrix. Radii parameters are given by -R, -r.&quot;</span> &lt;&lt; <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">endl</a></div>
<div class="line"><a id="l00719" name="l00719"></a><span class="lineno">  719</span>       &lt;&lt; <span class="stringliteral">&quot; - II       : normal estimator by Integral Invariants. Radius parameter is given by -r.&quot;</span> &lt;&lt; <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">endl</a></div>
<div class="line"><a id="l00720" name="l00720"></a><span class="lineno">  720</span>       &lt;&lt; <span class="stringliteral">&quot; - Trivial  : the normal obtained by average trivial surfel normals in a ball neighborhood. Radius parameter is given by -r.&quot;</span> &lt;&lt; <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">endl</a></div>
<div class="line"><a id="l00721" name="l00721"></a><span class="lineno">  721</span>       &lt;&lt; <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">endl</a>;</div>
<div class="line"><a id="l00722" name="l00722"></a><span class="lineno">  722</span>  <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">ss_descr</a> &lt;&lt; <span class="stringliteral">&quot;Note:&quot;</span> &lt;&lt; <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">endl</a></div>
<div class="line"><a id="l00723" name="l00723"></a><span class="lineno">  723</span>       &lt;&lt; <span class="stringliteral">&quot;     - This is a normal *direction* evaluator more than a normal vector evaluator. Orientations of normals are deduced from ground truth. This is due to the fact that II and VCM only estimates normal directions.&quot;</span> &lt;&lt; <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">endl</a></div>
<div class="line"><a id="l00724" name="l00724"></a><span class="lineno">  724</span>       &lt;&lt; <span class="stringliteral">&quot;     - This tool only analyses one surface component, and one that contains at least as many surfels as the width of the digital bounding box. This is required when analysing noisy data, where a lot of the small components are spurious. The drawback is that you cannot analyse the normals on a surface with several components.&quot;</span> &lt;&lt; <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">endl</a>;</div>
<div class="line"><a id="l00725" name="l00725"></a><span class="lineno">  725</span>  </div>
<div class="line"><a id="l00726" name="l00726"></a><span class="lineno">  726</span>  <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">app</a>.description(<a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">ss_descr</a>.str());</div>
<div class="line"><a id="l00727" name="l00727"></a><span class="lineno">  727</span>  </div>
<div class="line"><a id="l00728" name="l00728"></a><span class="lineno">  728</span>  <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">app</a>.add_option(<span class="stringliteral">&quot;--polynomial,-p&quot;</span>,<a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">allParams</a>.polynomials, <span class="stringliteral">&quot;the implicit polynomial whose zero-level defines the shape of interest.&quot;</span>) -&gt;required();</div>
<div class="line"><a id="l00729" name="l00729"></a><span class="lineno">  729</span>  <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">app</a>.add_option(<span class="stringliteral">&quot;--noise,-N&quot;</span>, <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">allParams</a>.noise,<span class="stringliteral">&quot;the Kanungo noise level l=arg, with l^d the probability that a point at distance d is flipped inside/outside.&quot;</span> );</div>
<div class="line"><a id="l00730" name="l00730"></a><span class="lineno">  730</span>  <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">app</a>.add_option(<span class="stringliteral">&quot;--minAABB,-a&quot;</span>, <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">allParams</a>.minAABB, <span class="stringliteral">&quot;the min value of the AABB bounding box (domain)&quot;</span> );</div>
<div class="line"><a id="l00731" name="l00731"></a><span class="lineno">  731</span>  <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">app</a>.add_option(<span class="stringliteral">&quot;--maxAABB,-A&quot;</span>, <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">allParams</a>.maxAABB, <span class="stringliteral">&quot;the max value of the AABB bounding box (domain)&quot;</span> );</div>
<div class="line"><a id="l00732" name="l00732"></a><span class="lineno">  732</span>  <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">app</a>.add_option(<span class="stringliteral">&quot;--gridstep,-g&quot;</span>, <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">allParams</a>.gridstep, <span class="stringliteral">&quot;the gridstep that defines the digitization (often called h).&quot;</span>);</div>
<div class="line"><a id="l00733" name="l00733"></a><span class="lineno">  733</span>  <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">app</a>.add_option(<span class="stringliteral">&quot;--estimator,-e&quot;</span>, <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">allParams</a>.estimator, <span class="stringliteral">&quot;the chosen normal estimator: True | VCM | II | Trivial&quot;</span>)</div>
<div class="line"><a id="l00734" name="l00734"></a><span class="lineno">  734</span>  -&gt; <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">check</a>(CLI::IsMember({<span class="stringliteral">&quot;True&quot;</span>, <span class="stringliteral">&quot;VCM&quot;</span>, <span class="stringliteral">&quot;II&quot;</span>, <span class="stringliteral">&quot;Trivial&quot;</span>}));</div>
<div class="line"><a id="l00735" name="l00735"></a><span class="lineno">  735</span>  <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">app</a>.add_option(<span class="stringliteral">&quot;--R-radius,-R&quot;</span>, <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">allParams</a>.R_radius, <span class="stringliteral">&quot;the constant for parameter R in R(h)=R h^alpha (VCM).&quot;</span>);</div>
<div class="line"><a id="l00736" name="l00736"></a><span class="lineno">  736</span>  <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">app</a>.add_option(<span class="stringliteral">&quot;--r-radius,-r&quot;</span>, <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">allParams</a>.r_radius, <span class="stringliteral">&quot;the constant for parameter r in r(h)=r h^alpha (VCM,II,Trivial).&quot;</span>);</div>
<div class="line"><a id="l00737" name="l00737"></a><span class="lineno">  737</span>  <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">app</a>.add_option(<span class="stringliteral">&quot;--kernel,-k&quot;</span>, <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">allParams</a>.kernel, <span class="stringliteral">&quot;the function chi_r, either hat or ball.&quot;</span>);</div>
<div class="line"><a id="l00738" name="l00738"></a><span class="lineno">  738</span>  <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">app</a>.add_option(<span class="stringliteral">&quot;--alpha&quot;</span>, <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">allParams</a>.alpha, <span class="stringliteral">&quot;the parameter alpha in r(h)=r h^alpha (VCM).&quot;</span>);</div>
<div class="line"><a id="l00739" name="l00739"></a><span class="lineno">  739</span>  <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">app</a>.add_option(<span class="stringliteral">&quot;--trivial-radius,-t&quot;</span>, <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">allParams</a>.trivial_radius, <span class="stringliteral">&quot;the parameter t defining the radius for the Trivial estimator. Also used for reorienting the VCM.&quot;</span>);</div>
<div class="line"><a id="l00740" name="l00740"></a><span class="lineno">  740</span>  <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">app</a>.add_option(<span class="stringliteral">&quot;--embedding,-E&quot;</span>,<a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">allParams</a>.embedding, <span class="stringliteral">&quot;the surfel -&gt; point embedding for VCM estimator: 0: Pointels, 1: InnerSpel, 2: OuterSpel.&quot;</span>);</div>
<div class="line"><a id="l00741" name="l00741"></a><span class="lineno">  741</span>  <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">app</a>.add_option(<span class="stringliteral">&quot;--output,-o&quot;</span>, <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">allParams</a>.output, <span class="stringliteral">&quot;the output basename. All generated files will have the form &lt;arg&gt;-*, for instance &lt;arg&gt;-angle-deviation-&lt;gridstep&gt;.txt, &lt;arg&gt;-normals-&lt;gridstep&gt;.txt, &lt;arg&gt;-cells-&lt;gridstep&gt;.txt, &lt;arg&gt;-noff-&lt;gridstep&gt;.off.&quot;</span>);</div>
<div class="line"><a id="l00742" name="l00742"></a><span class="lineno">  742</span>  <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">app</a>.add_flag(<span class="stringliteral">&quot;--angle-deviation-stats,-S&quot;</span>, <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">allParams</a>.angle_deviation_stats, <span class="stringliteral">&quot;computes angle deviation error and outputs them in file &lt;basename&gt;-angle-deviation-&lt;gridstep&gt;.txt, as specified by -o &lt;basename&gt;.&quot;</span>);</div>
<div class="line"><a id="l00743" name="l00743"></a><span class="lineno">  743</span> </div>
<div class="line"><a id="l00744" name="l00744"></a><span class="lineno">  744</span>  <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">app</a>.add_option(<span class="stringliteral">&quot;--export,-x&quot;</span>,<a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">allParams</a>.exportX, <span class="stringliteral">&quot;exports surfel normals which can be viewed with ImaGene tool &#39;viewSetOfSurfels&#39; in file &lt;basename&gt;-cells-&lt;gridstep&gt;.txt, as specified by -o &lt;basename&gt;. Parameter &lt;arg&gt; is None|Normals|AngleDeviation. The color depends on the angle deviation in degree: 0 metallic blue, 5 light cyan, 10 light green, 15 light yellow, 20 yellow, 25 orange, 30 red, 35, dark red, 40- grey&quot;</span> );</div>
<div class="line"><a id="l00745" name="l00745"></a><span class="lineno">  745</span>  <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">app</a>.add_flag(<span class="stringliteral">&quot;--normals,-n&quot;</span>, <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">allParams</a>.normals, <span class="stringliteral">&quot;outputs every surfel, its estimated normal, and the ground truth normal in file &lt;basename&gt;-normals-&lt;gridstep&gt;.txt, as specified by -o &lt;basename&gt;.&quot;</span>);</div>
<div class="line"><a id="l00746" name="l00746"></a><span class="lineno">  746</span>  <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">app</a>.add_flag(<span class="stringliteral">&quot;--noff,-O&quot;</span>, <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">allParams</a>.noff, <span class="stringliteral">&quot;exports the digital surface with normals as NOFF file &lt;basename&gt;-noff-&lt;gridstep&gt;.off, as specified by -o &lt;basename&gt;..&quot;</span>);</div>
<div class="line"><a id="l00747" name="l00747"></a><span class="lineno">  747</span><span class="preprocessor">#ifdef DGTAL_WITH_VISU3D_QGLVIEWER</span></div>
<div class="line"><a id="l00748" name="l00748"></a><span class="lineno">  748</span>  <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">app</a>.add_option(<span class="stringliteral">&quot;--view,-V&quot;</span>, <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">allParams</a>.view, <span class="stringliteral">&quot;view the digital surface with normals.  Parameter &lt;arg&gt; is None|Normals|AngleDeviation. The color depends on the angle deviation in degree: 0 metallic blue, 5 light cyan, 10 light green, 15 light yellow, 20 yellow, 25 orange, 30 red, 35, dark red, 40- grey.&quot;</span>);</div>
<div class="line"><a id="l00749" name="l00749"></a><span class="lineno">  749</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00750" name="l00750"></a><span class="lineno">  750</span> </div>
<div class="line"><a id="l00751" name="l00751"></a><span class="lineno">  751</span>  </div>
<div class="line"><a id="l00752" name="l00752"></a><span class="lineno">  752</span>  <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">app</a>.get_formatter()-&gt;column_width(40);</div>
<div class="line"><a id="l00753" name="l00753"></a><span class="lineno">  753</span>  <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">CLI11_PARSE</a>(<a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">app</a>, <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">argc</a>, <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">argv</a>);</div>
<div class="line"><a id="l00754" name="l00754"></a><span class="lineno">  754</span>  <span class="comment">// END parse command line using CLI ----------------------------------------------</span></div>
<div class="line"><a id="l00755" name="l00755"></a><span class="lineno">  755</span> </div>
<div class="line"><a id="l00756" name="l00756"></a><span class="lineno">  756</span>  </div>
<div class="line"><a id="l00757" name="l00757"></a><span class="lineno">  757</span>  </div>
<div class="line"><a id="l00758" name="l00758"></a><span class="lineno">  758</span>  <a class="code hl_variableRef" href="https://dgtal-team.github.io/doc-nightly/namespaceDGtal.html#a604c07ec391ad12a1f3fb6479993f112">trace</a>.<a class="code hl_functionRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Trace.html#a352b7160bf722e2f0bcbee5d0bad6ef3">beginBlock</a>( <span class="stringliteral">&quot;Make implicit shape...&quot;</span> );</div>
<div class="line"><a id="l00759" name="l00759"></a><span class="lineno">  759</span>  <span class="keyword">typedef</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">Z3i::Space</a> <a class="code hl_typedefRef" href="https://dgtal-team.github.io/doc-nightly/namespaceDGtal_1_1Z2i.html#a9b96ab8175cf9c54b1f451858ccd46a4">Space</a>;</div>
<div class="line"><a id="l00760" name="l00760"></a><span class="lineno">  760</span>  <span class="keyword">typedef</span> <span class="keywordtype">double</span> Scalar;</div>
<div class="line"><a id="l00761" name="l00761"></a><span class="lineno">  761</span>  <span class="keyword">typedef</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">MPolynomial&lt; 3, Scalar &gt;</a> Polynomial3;</div>
<div class="line"><a id="l00762" name="l00762"></a><span class="lineno">  762</span>  <span class="keyword">typedef</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">MPolynomialReader&lt;3, Scalar&gt;</a> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">Polynomial3Reader</a>;</div>
<div class="line"><a id="l00763" name="l00763"></a><span class="lineno">  763</span>  <span class="keyword">typedef</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">ImplicitPolynomial3Shape&lt;Space&gt;</a> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">ImplicitShape</a>;</div>
<div class="line"><a id="l00764" name="l00764"></a><span class="lineno">  764</span>  Polynomial3 <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">poly</a>;</div>
<div class="line"><a id="l00765" name="l00765"></a><span class="lineno">  765</span>  <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">Polynomial3Reader</a> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">reader</a>;</div>
<div class="line"><a id="l00766" name="l00766"></a><span class="lineno">  766</span>  string::const_iterator <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">iter</a> = <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">reader</a>.read( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">poly</a>, <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">allParams</a>.polynomials.begin(), <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">allParams</a>.polynomials.end() );</div>
<div class="line"><a id="l00767" name="l00767"></a><span class="lineno">  767</span>  <span class="keywordflow">if</span> ( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">iter</a> != <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">allParams</a>.polynomials.end() )</div>
<div class="line"><a id="l00768" name="l00768"></a><span class="lineno">  768</span>    {</div>
<div class="line"><a id="l00769" name="l00769"></a><span class="lineno">  769</span>      <a class="code hl_variableRef" href="https://dgtal-team.github.io/doc-nightly/namespaceDGtal.html#a604c07ec391ad12a1f3fb6479993f112">trace</a>.<a class="code hl_functionRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Trace.html#a1e786a1f3b1047e92b73c82f67e3c295">error</a>() &lt;&lt; <span class="stringliteral">&quot;ERROR reading polynomial: I read only &lt;&quot;</span> &lt;&lt; <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">allParams</a>.polynomials.substr( 0, <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">iter</a> - <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">allParams</a>.polynomials.begin() )</div>
<div class="line"><a id="l00770" name="l00770"></a><span class="lineno">  770</span>                    &lt;&lt; <span class="stringliteral">&quot;&gt;, and I built P=&quot;</span> &lt;&lt; <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">poly</a> &lt;&lt; std::endl;</div>
<div class="line"><a id="l00771" name="l00771"></a><span class="lineno">  771</span>      <span class="keywordflow">return</span> 2;</div>
<div class="line"><a id="l00772" name="l00772"></a><span class="lineno">  772</span>    }</div>
<div class="line"><a id="l00773" name="l00773"></a><span class="lineno">  773</span>  <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">CountedPtr&lt;ImplicitShape&gt;</a> shape( <span class="keyword">new</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">ImplicitShape</a>( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">poly</a> ) ); <span class="comment">// smart pointer</span></div>
<div class="line"><a id="l00774" name="l00774"></a><span class="lineno">  774</span>  <a class="code hl_variableRef" href="https://dgtal-team.github.io/doc-nightly/namespaceDGtal.html#a604c07ec391ad12a1f3fb6479993f112">trace</a>.<a class="code hl_functionRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Trace.html#afa3a2874289734884107b1ce68ccb93d">endBlock</a>();</div>
<div class="line"><a id="l00775" name="l00775"></a><span class="lineno">  775</span> </div>
<div class="line"><a id="l00776" name="l00776"></a><span class="lineno">  776</span>  <a class="code hl_variableRef" href="https://dgtal-team.github.io/doc-nightly/namespaceDGtal.html#a604c07ec391ad12a1f3fb6479993f112">trace</a>.<a class="code hl_functionRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Trace.html#a352b7160bf722e2f0bcbee5d0bad6ef3">beginBlock</a>( <span class="stringliteral">&quot;Make implicit digital shape...&quot;</span> );</div>
<div class="line"><a id="l00777" name="l00777"></a><span class="lineno">  777</span>  <span class="keyword">typedef</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">Z3i::KSpace</a> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1KhalimskySpaceND.html">KSpace</a>;</div>
<div class="line"><a id="l00778" name="l00778"></a><span class="lineno">  778</span>  <span class="keyword">typedef</span> Space::RealPoint RealPoint;</div>
<div class="line"><a id="l00779" name="l00779"></a><span class="lineno">  779</span>  <span class="keyword">typedef</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">GaussDigitizer&lt; Space, ImplicitShape &gt;</a> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">ImplicitDigitalShape</a>;</div>
<div class="line"><a id="l00780" name="l00780"></a><span class="lineno">  780</span>  <span class="keyword">typedef</span> ImplicitDigitalShape::Domain <a class="code hl_typedefRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1IteratorCompletionTraits_3_01ArrayImageAdapter_3_01TArrayIterator_00_01TDomain_01_4_01_4_1_1DistanceFunctor.html#a79a0f67cc951326052b97eeea300e2c1">Domain</a>;</div>
<div class="line"><a id="l00781" name="l00781"></a><span class="lineno">  781</span>  Scalar <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">min_x</a> = <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">allParams</a>.minAABB;</div>
<div class="line"><a id="l00782" name="l00782"></a><span class="lineno">  782</span>  Scalar <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">max_x</a> = <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">allParams</a>.maxAABB;</div>
<div class="line"><a id="l00783" name="l00783"></a><span class="lineno">  783</span>  Scalar h = <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">allParams</a>.gridstep;</div>
<div class="line"><a id="l00784" name="l00784"></a><span class="lineno">  784</span>  RealPoint <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">p1</a>( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">min_x</a>, <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">min_x</a>, <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">min_x</a> );</div>
<div class="line"><a id="l00785" name="l00785"></a><span class="lineno">  785</span>  RealPoint <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">p2</a>( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">max_x</a>, <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">max_x</a>, <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">max_x</a> );</div>
<div class="line"><a id="l00786" name="l00786"></a><span class="lineno">  786</span>  <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">CountedPtr&lt;ImplicitDigitalShape&gt;</a> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">dshape</a>( <span class="keyword">new</span> <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">ImplicitDigitalShape</a>() );</div>
<div class="line"><a id="l00787" name="l00787"></a><span class="lineno">  787</span>  <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">dshape</a>-&gt;attach( *shape );</div>
<div class="line"><a id="l00788" name="l00788"></a><span class="lineno">  788</span>  <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">dshape</a>-&gt;init( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">p1</a>, <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">p2</a>, h );</div>
<div class="line"><a id="l00789" name="l00789"></a><span class="lineno">  789</span>  <a class="code hl_typedefRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1IteratorCompletionTraits_3_01ArrayImageAdapter_3_01TArrayIterator_00_01TDomain_01_4_01_4_1_1DistanceFunctor.html#a79a0f67cc951326052b97eeea300e2c1">Domain</a> domain = <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">dshape</a>-&gt;getDomain();</div>
<div class="line"><a id="l00790" name="l00790"></a><span class="lineno">  790</span>  <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1KhalimskySpaceND.html">KSpace</a> K;</div>
<div class="line"><a id="l00791" name="l00791"></a><span class="lineno">  791</span>  K.<a class="code hl_functionRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1KhalimskySpaceND.html#a15dcbcaae831dd1c36090e6336c177d4">init</a>( domain.lowerBound(), domain.upperBound(), <span class="keyword">true</span> );</div>
<div class="line"><a id="l00792" name="l00792"></a><span class="lineno">  792</span>  <a class="code hl_variableRef" href="https://dgtal-team.github.io/doc-nightly/namespaceDGtal.html#a604c07ec391ad12a1f3fb6479993f112">trace</a>.<a class="code hl_functionRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Trace.html#ad054990834d2763627166540087a2980">info</a>() &lt;&lt; <span class="stringliteral">&quot;- domain is &quot;</span> &lt;&lt; domain &lt;&lt; std::endl;</div>
<div class="line"><a id="l00793" name="l00793"></a><span class="lineno">  793</span>  <a class="code hl_variableRef" href="https://dgtal-team.github.io/doc-nightly/namespaceDGtal.html#a604c07ec391ad12a1f3fb6479993f112">trace</a>.<a class="code hl_functionRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Trace.html#afa3a2874289734884107b1ce68ccb93d">endBlock</a>();</div>
<div class="line"><a id="l00794" name="l00794"></a><span class="lineno">  794</span> </div>
<div class="line"><a id="l00795" name="l00795"></a><span class="lineno">  795</span>  chooseSurface( <a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">allParams</a>, K, *shape, *<a class="code hl_classRef" href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">dshape</a> );</div>
<div class="line"><a id="l00796" name="l00796"></a><span class="lineno">  796</span> </div>
<div class="line"><a id="l00797" name="l00797"></a><span class="lineno">  797</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a id="l00798" name="l00798"></a><span class="lineno">  798</span>}</div>
<div class="line"><a id="l00799" name="l00799"></a><span class="lineno">  799</span> </div>
<div class="ttc" id="aclassDGtal_1_1Color_html"><div class="ttname"><a href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Color.html">DGtal::Color</a></div></div>
<div class="ttc" id="aclassDGtal_1_1Color_html_a5917f9d174eb75eae2ce49e7f40edbb7"><div class="ttname"><a href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Color.html#a5917f9d174eb75eae2ce49e7f40edbb7">DGtal::Color::green</a></div><div class="ttdeci">void green(const unsigned char aGreenValue)</div></div>
<div class="ttc" id="aclassDGtal_1_1Color_html_aa487b3d008dc44964b10971ce8a26432"><div class="ttname"><a href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Color.html#aa487b3d008dc44964b10971ce8a26432">DGtal::Color::red</a></div><div class="ttdeci">void red(const unsigned char aRedValue)</div></div>
<div class="ttc" id="aclassDGtal_1_1Color_html_af51469f44cfc0603c66efe150b1b0c33"><div class="ttname"><a href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Color.html#af51469f44cfc0603c66efe150b1b0c33">DGtal::Color::blue</a></div><div class="ttdeci">void blue(const unsigned char aBlueValue)</div></div>
<div class="ttc" id="aclassDGtal_1_1DigitalSurface_html"><div class="ttname"><a href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1DigitalSurface.html">DGtal::DigitalSurface</a></div></div>
<div class="ttc" id="aclassDGtal_1_1DigitalSurface_html_a00e29d43b6f9d0313c7134aec8c4f4ee"><div class="ttname"><a href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1DigitalSurface.html#a00e29d43b6f9d0313c7134aec8c4f4ee">DGtal::DigitalSurface::end</a></div><div class="ttdeci">ConstIterator end() const</div></div>
<div class="ttc" id="aclassDGtal_1_1DigitalSurface_html_a49b0a08eb04ed843d3e2c9ac7112a913"><div class="ttname"><a href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1DigitalSurface.html#a49b0a08eb04ed843d3e2c9ac7112a913">DGtal::DigitalSurface::begin</a></div><div class="ttdeci">ConstIterator begin() const</div></div>
<div class="ttc" id="aclassDGtal_1_1DigitalSurface_html_a9d7e0f91191e8e4d7ee1257623aff04f"><div class="ttname"><a href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1DigitalSurface.html#a9d7e0f91191e8e4d7ee1257623aff04f">DGtal::DigitalSurface::exportAs3DNOFF</a></div><div class="ttdeci">void exportAs3DNOFF(std::ostream &amp;out, const SCellEmbedderWithGradientMap &amp;scembedder) const</div></div>
<div class="ttc" id="aclassDGtal_1_1DigitalSurface_html_afd10471a6fb7fb58e5f8744a8b6c1713"><div class="ttname"><a href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1DigitalSurface.html#afd10471a6fb7fb58e5f8744a8b6c1713">DGtal::DigitalSurface::container</a></div><div class="ttdeci">const DigitalSurfaceContainer &amp; container() const</div></div>
<div class="ttc" id="aclassDGtal_1_1ImageContainerBySTLVector_html"><div class="ttname"><a href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1ImageContainerBySTLVector.html">DGtal::ImageContainerBySTLVector</a></div></div>
<div class="ttc" id="aclassDGtal_1_1Image_html"><div class="ttname"><a href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Image.html">DGtal::Image</a></div></div>
<div class="ttc" id="aclassDGtal_1_1InputException_html"><div class="ttname"><a href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1InputException.html">DGtal::InputException</a></div></div>
<div class="ttc" id="aclassDGtal_1_1IteratorCompletionTraits_3_01ArrayImageAdapter_3_01TArrayIterator_00_01TDomain_01_4_01_4_1_1DistanceFunctor_html_a79a0f67cc951326052b97eeea300e2c1"><div class="ttname"><a href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1IteratorCompletionTraits_3_01ArrayImageAdapter_3_01TArrayIterator_00_01TDomain_01_4_01_4_1_1DistanceFunctor.html#a79a0f67cc951326052b97eeea300e2c1">Domain</a></div><div class="ttdeci">typename Self::Domain Domain</div></div>
<div class="ttc" id="aclassDGtal_1_1IteratorCompletionTraits_3_01ArrayImageAdapter_3_01TArrayIterator_00_01TDomain_01_4_01_4_1_1DistanceFunctor_html_af185de5027177db2d1b4a0b775be8c3f"><div class="ttname"><a href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1IteratorCompletionTraits_3_01ArrayImageAdapter_3_01TArrayIterator_00_01TDomain_01_4_01_4_1_1DistanceFunctor.html#af185de5027177db2d1b4a0b775be8c3f">Point</a></div><div class="ttdeci">typename Self::Point Point</div></div>
<div class="ttc" id="aclassDGtal_1_1KhalimskySpaceND_html"><div class="ttname"><a href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1KhalimskySpaceND.html">DGtal::KhalimskySpaceND</a></div></div>
<div class="ttc" id="aclassDGtal_1_1KhalimskySpaceND_html_a15dcbcaae831dd1c36090e6336c177d4"><div class="ttname"><a href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1KhalimskySpaceND.html#a15dcbcaae831dd1c36090e6336c177d4">DGtal::KhalimskySpaceND::init</a></div><div class="ttdeci">bool init(const Point &amp;lower, const Point &amp;upper, bool isClosed)</div></div>
<div class="ttc" id="aclassDGtal_1_1KhalimskySpaceND_html_a172911293fde220bd965f147a9a320da"><div class="ttname"><a href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1KhalimskySpaceND.html#a172911293fde220bd965f147a9a320da">DGtal::KhalimskySpaceND::upperBound</a></div><div class="ttdeci">const Point &amp; upperBound() const</div></div>
<div class="ttc" id="aclassDGtal_1_1KhalimskySpaceND_html_a71a96a90f5935efbccfff1d98b874c2d"><div class="ttname"><a href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1KhalimskySpaceND.html#a71a96a90f5935efbccfff1d98b874c2d">DGtal::KhalimskySpaceND::sKCoord</a></div><div class="ttdeci">Integer sKCoord(const SCell &amp;c, Dimension k) const</div></div>
<div class="ttc" id="aclassDGtal_1_1KhalimskySpaceND_html_a784c9fb251aba0f7db2adc934fe666b1"><div class="ttname"><a href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1KhalimskySpaceND.html#a784c9fb251aba0f7db2adc934fe666b1">DGtal::KhalimskySpaceND::sSign</a></div><div class="ttdeci">Sign sSign(const SCell &amp;c) const</div></div>
<div class="ttc" id="aclassDGtal_1_1KhalimskySpaceND_html_a7d29934a9526b8fc98cb96e63ed073b1"><div class="ttname"><a href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1KhalimskySpaceND.html#a7d29934a9526b8fc98cb96e63ed073b1">DGtal::KhalimskySpaceND::lowerBound</a></div><div class="ttdeci">const Point &amp; lowerBound() const</div></div>
<div class="ttc" id="aclassDGtal_1_1PointVector_html"><div class="ttname"><a href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1PointVector.html">PointVector&lt; dim, Integer &gt;</a></div></div>
<div class="ttc" id="aclassDGtal_1_1Surfaces_html_a48e3a0e7c4728f6a6f23ec6f468a41b8"><div class="ttname"><a href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Surfaces.html#a48e3a0e7c4728f6a6f23ec6f468a41b8">DGtal::Surfaces::findABel</a></div><div class="ttdeci">static SCell findABel(const KSpace &amp;K, const PointPredicate &amp;pp, unsigned int nbtries=1000)</div></div>
<div class="ttc" id="aclassDGtal_1_1SurfelAdjacency_html"><div class="ttname"><a href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1SurfelAdjacency.html">SurfelAdjacency&lt; KSpace::dimension &gt;</a></div></div>
<div class="ttc" id="aclassDGtal_1_1Trace_html_a1e786a1f3b1047e92b73c82f67e3c295"><div class="ttname"><a href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Trace.html#a1e786a1f3b1047e92b73c82f67e3c295">DGtal::Trace::error</a></div><div class="ttdeci">std::ostream &amp; error()</div></div>
<div class="ttc" id="aclassDGtal_1_1Trace_html_a352b7160bf722e2f0bcbee5d0bad6ef3"><div class="ttname"><a href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Trace.html#a352b7160bf722e2f0bcbee5d0bad6ef3">DGtal::Trace::beginBlock</a></div><div class="ttdeci">void beginBlock(const std::string &amp;keyword=&quot;&quot;)</div></div>
<div class="ttc" id="aclassDGtal_1_1Trace_html_ad054990834d2763627166540087a2980"><div class="ttname"><a href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Trace.html#ad054990834d2763627166540087a2980">DGtal::Trace::info</a></div><div class="ttdeci">std::ostream &amp; info()</div></div>
<div class="ttc" id="aclassDGtal_1_1Trace_html_afa3a2874289734884107b1ce68ccb93d"><div class="ttname"><a href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1Trace.html#afa3a2874289734884107b1ce68ccb93d">DGtal::Trace::endBlock</a></div><div class="ttdeci">double endBlock()</div></div>
<div class="ttc" id="aclassDGtal_1_1VCMDigitalSurfaceLocalEstimator_html"><div class="ttname"><a href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1VCMDigitalSurfaceLocalEstimator.html">DGtal::VCMDigitalSurfaceLocalEstimator</a></div></div>
<div class="ttc" id="aclassDGtal_1_1VoronoiCovarianceMeasureOnDigitalSurface_html"><div class="ttname"><a href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1VoronoiCovarianceMeasureOnDigitalSurface.html">DGtal::VoronoiCovarianceMeasureOnDigitalSurface</a></div></div>
<div class="ttc" id="aclassDGtal_1_1functors_1_1IINormalDirectionFunctor_html"><div class="ttname"><a href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1functors_1_1IINormalDirectionFunctor.html">DGtal::functors::IINormalDirectionFunctor</a></div></div>
<div class="ttc" id="aclassDGtal_1_1functors_1_1SimpleThresholdForegroundPredicate_html"><div class="ttname"><a href="https://dgtal-team.github.io/doc-nightly/classDGtal_1_1functors_1_1SimpleThresholdForegroundPredicate.html">DGtal::functors::SimpleThresholdForegroundPredicate</a></div></div>
<div class="ttc" id="anamespaceDGtal_1_1Z2i_html_a0db3f1b80b0d65707785c1072244befc"><div class="ttname"><a href="https://dgtal-team.github.io/doc-nightly/namespaceDGtal_1_1Z2i.html#a0db3f1b80b0d65707785c1072244befc">DGtal::Z2i::RealVector</a></div><div class="ttdeci">Space::RealVector RealVector</div></div>
<div class="ttc" id="anamespaceDGtal_1_1Z2i_html_a9b96ab8175cf9c54b1f451858ccd46a4"><div class="ttname"><a href="https://dgtal-team.github.io/doc-nightly/namespaceDGtal_1_1Z2i.html#a9b96ab8175cf9c54b1f451858ccd46a4">DGtal::Z2i::Space</a></div><div class="ttdeci">SpaceND&lt; 2, Integer &gt; Space</div></div>
<div class="ttc" id="anamespaceDGtal_html"><div class="ttname"><a href="https://dgtal-team.github.io/doc-nightly/namespaceDGtal.html">DGtal</a></div></div>
<div class="ttc" id="anamespaceDGtal_html_a604c07ec391ad12a1f3fb6479993f112"><div class="ttname"><a href="https://dgtal-team.github.io/doc-nightly/namespaceDGtal.html#a604c07ec391ad12a1f3fb6479993f112">DGtal::trace</a></div><div class="ttdeci">Trace trace(traceWriterTerm)</div></div>
<div class="ttc" id="anamespaceDGtal_html_aaad242ffef715835e8928579a506b2d5"><div class="ttname"><a href="https://dgtal-team.github.io/doc-nightly/namespaceDGtal.html#aaad242ffef715835e8928579a506b2d5">DGtal::Surfel2PointEmbedding</a></div><div class="ttdeci">Surfel2PointEmbedding</div></div>
<div class="ttc" id="anamespaceDGtal_html_aaad242ffef715835e8928579a506b2d5a0630efc9b8129aa1ad3233bba9f08423"><div class="ttname"><a href="https://dgtal-team.github.io/doc-nightly/namespaceDGtal.html#aaad242ffef715835e8928579a506b2d5a0630efc9b8129aa1ad3233bba9f08423">DGtal::OuterSpel</a></div><div class="ttdeci">OuterSpel</div></div>
<div class="ttc" id="anamespaceDGtal_html_aaad242ffef715835e8928579a506b2d5a800e26ee60cfa63833cffca955ae401f"><div class="ttname"><a href="https://dgtal-team.github.io/doc-nightly/namespaceDGtal.html#aaad242ffef715835e8928579a506b2d5a800e26ee60cfa63833cffca955ae401f">DGtal::InnerSpel</a></div><div class="ttdeci">InnerSpel</div></div>
<div class="ttc" id="anamespaceDGtal_html_aaad242ffef715835e8928579a506b2d5ac0a8bc5774ff6530ee71a7cacd6ca6f4"><div class="ttname"><a href="https://dgtal-team.github.io/doc-nightly/namespaceDGtal.html#aaad242ffef715835e8928579a506b2d5ac0a8bc5774ff6530ee71a7cacd6ca6f4">DGtal::Pointels</a></div><div class="ttdeci">Pointels</div></div>
<div class="ttc" id="astructDGtal_1_1CanonicSCellEmbedder_html"><div class="ttname"><a href="https://dgtal-team.github.io/doc-nightly/structDGtal_1_1CanonicSCellEmbedder.html">DGtal::CanonicSCellEmbedder</a></div></div>
<div class="ttc" id="astructDGtal_1_1CanonicSCellEmbedder_html_a179ed9fa2a17a402c88cf3a9adab87db"><div class="ttname"><a href="https://dgtal-team.github.io/doc-nightly/structDGtal_1_1CanonicSCellEmbedder.html#a179ed9fa2a17a402c88cf3a9adab87db">DGtal::CanonicSCellEmbedder::space</a></div><div class="ttdeci">const KSpace &amp; space() const</div></div>
<div class="ttc" id="astructDGtal_1_1CanonicSCellEmbedder_html_a1b7722292b1ed4efc2c7353e452c2b9a"><div class="ttname"><a href="https://dgtal-team.github.io/doc-nightly/structDGtal_1_1CanonicSCellEmbedder.html#a1b7722292b1ed4efc2c7353e452c2b9a">DGtal::CanonicSCellEmbedder::KSpace</a></div><div class="ttdeci">TKSpace KSpace</div></div>
<div class="ttc" id="astructDGtal_1_1CanonicSCellEmbedder_html_a2073127fbff644a772ea9749b723e5e4"><div class="ttname"><a href="https://dgtal-team.github.io/doc-nightly/structDGtal_1_1CanonicSCellEmbedder.html#a2073127fbff644a772ea9749b723e5e4">DGtal::CanonicSCellEmbedder::Argument</a></div><div class="ttdeci">SCell Argument</div></div>
<div class="ttc" id="astructDGtal_1_1CanonicSCellEmbedder_html_aba9d5a4aab713249a99e12765264d1da"><div class="ttname"><a href="https://dgtal-team.github.io/doc-nightly/structDGtal_1_1CanonicSCellEmbedder.html#aba9d5a4aab713249a99e12765264d1da">DGtal::CanonicSCellEmbedder::RealPoint</a></div><div class="ttdeci">Space::RealPoint RealPoint</div></div>
<div class="ttc" id="astructDGtal_1_1CanonicSCellEmbedder_html_ac30f6fa662fd17cf2276aa749c182194"><div class="ttname"><a href="https://dgtal-team.github.io/doc-nightly/structDGtal_1_1CanonicSCellEmbedder.html#ac30f6fa662fd17cf2276aa749c182194">DGtal::CanonicSCellEmbedder::Value</a></div><div class="ttdeci">RealPoint Value</div></div>
<div class="ttc" id="astructDGtal_1_1CanonicSCellEmbedder_html_acd8f38ec4f86b9ef17ebde3f3c2987f4"><div class="ttname"><a href="https://dgtal-team.github.io/doc-nightly/structDGtal_1_1CanonicSCellEmbedder.html#acd8f38ec4f86b9ef17ebde3f3c2987f4">DGtal::CanonicSCellEmbedder::SCell</a></div><div class="ttdeci">KSpace::SCell SCell</div></div>
<div class="ttc" id="astructDGtal_1_1SignedKhalimskyCell_html"><div class="ttname"><a href="https://dgtal-team.github.io/doc-nightly/structDGtal_1_1SignedKhalimskyCell.html">DGtal::SignedKhalimskyCell</a></div></div>
<div class="ttc" id="astructDGtal_1_1functors_1_1BallConstantPointFunction_html"><div class="ttname"><a href="https://dgtal-team.github.io/doc-nightly/structDGtal_1_1functors_1_1BallConstantPointFunction.html">DGtal::functors::BallConstantPointFunction</a></div></div>
<div class="ttc" id="astructDGtal_1_1functors_1_1HatPointFunction_html"><div class="ttname"><a href="https://dgtal-team.github.io/doc-nightly/structDGtal_1_1functors_1_1HatPointFunction.html">DGtal::functors::HatPointFunction</a></div></div>
<div class="ttc" id="astructDGtal_1_1functors_1_1ShapeGeometricFunctors_1_1ShapeNormalVectorFunctor_html"><div class="ttname"><a href="https://dgtal-team.github.io/doc-nightly/structDGtal_1_1functors_1_1ShapeGeometricFunctors_1_1ShapeNormalVectorFunctor.html">DGtal::functors::ShapeGeometricFunctors::ShapeNormalVectorFunctor</a></div></div>
<div class="ttc" id="astructDGtal_1_1functors_1_1VCMNormalVectorFunctor_html"><div class="ttname"><a href="https://dgtal-team.github.io/doc-nightly/structDGtal_1_1functors_1_1VCMNormalVectorFunctor.html">DGtal::functors::VCMNormalVectorFunctor</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.11-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Companion project associated to  <a href= "http://liris.cnrs.fr/dgtal/doc/nightly/"> DGtal </a>;
    Generated on Mon Jul 14 2025 19:54:39 for DGtalTools by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.9.8
</small></address>
</body>
</html>
